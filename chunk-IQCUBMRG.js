import{b as z,c as V,f as E,o as F}from"./chunk-DOKJHZWU.js";import{a as A}from"./chunk-LGBSUADE.js";import{$a as u,Bb as _,Eb as S,Ia as y,Ma as d,S as x,Ta as l,Tb as I,Ua as i,Ub as N,Va as s,Wa as C,X as g,Xb as M,Xc as O,Y as f,Za as h,_a as p,a as v,b as D,ea as c,hb as b,jb as w,jd as T,kd as k,ta as r}from"./chunk-A3GKMUNS.js";function $(n,e){if(n&1){let t=h();i(0,"div",8),p("click",function(){g(t);let a=u();return f(a.isOpen.set(!1))}),s()}}function P(n,e){if(n&1){let t=h();i(0,"li",11),p("click",function(){let a=g(t).$implicit,m=u(2);return f(m.selectDoctor(a))}),i(1,"span",12),b(2),s()()}if(n&2){let t=e.$implicit;r(2),w(" ",t.displayName," ")}}function j(n,e){if(n&1&&(i(0,"ul",9),d(1,P,3,1,"li",10),s()),n&2){let t=u();r(),l("ngForOf",t.filteredOptions())}}function B(n,e){n&1&&(i(0,"ul",13)(1,"li",14),b(2," No se encontraron resultados "),s()())}var L=class n{doctorService=x(A);selectedDoctorId=c("");disabled=c(!1);selectionChanged=S();set setDisabled(e){this.disabled.set(e)}isOpen=c(!1);searchText=c("");doctors=this.doctorService.doctors;icons={Search:O};formattedDoctors=_(()=>this.doctors().filter(e=>!e.roles?.some(t=>typeof t=="string"&&t.toUpperCase()==="ADMIN")).map(e=>D(v({},e),{valueId:e.doctorId||e.id,displayName:e.dni?`${e.dni} - ${e.fullName}`:e.fullName})));filteredOptions=_(()=>{let e=this.searchText().toLowerCase();return this.formattedDoctors().filter(t=>t.displayName.toLowerCase().includes(e))});onSearchChange(e){this.searchText.set(e),this.isOpen.set(!0),e||(this.selectedDoctorId.set(""),this.selectionChanged.emit(""))}selectDoctor(e){if(!e.valueId){console.warn("Selected doctor has no doctorId/valueId",e);return}this.selectedDoctorId.set(e.valueId),this.searchText.set(e.displayName),this.isOpen.set(!1),this.selectionChanged.emit(e.valueId)}clear(){this.selectedDoctorId.set(""),this.searchText.set(""),this.selectionChanged.emit("")}setValue(e){let t=this.formattedDoctors().find(o=>o.valueId===e);t?(this.selectedDoctorId.set(e),this.searchText.set(t.displayName)):(this.selectedDoctorId.set(""),this.searchText.set(""))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=y({type:n,selectors:[["app-doctor-selector"]],inputs:{setDisabled:[0,"disabled","setDisabled"]},outputs:{selectionChanged:"selectionChanged"},decls:8,vars:5,consts:[[1,"relative","w-full"],["class","fixed inset-0 z-30 cursor-default bg-transparent",3,"click",4,"ngIf"],[1,"relative","z-40"],["type","text","placeholder","Buscar por DNI o Nombre...",1,"block","w-full","rounded-md","border-gray-300","py-2","pl-3","pr-10","text-base","focus:border-blue-500","focus:outline-none","focus:ring-blue-500","sm:text-sm","border","disabled:bg-gray-100","disabled:text-gray-500",3,"ngModelChange","focus","ngModel"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-2","pointer-events-none"],[1,"h-4","w-4","text-gray-400",3,"img"],["class","absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",4,"ngIf"],["class","absolute z-50 mt-1 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",4,"ngIf"],[1,"fixed","inset-0","z-30","cursor-default","bg-transparent",3,"click"],[1,"absolute","z-50","mt-1","max-h-60","w-full","overflow-auto","rounded-md","bg-white","py-1","text-base","shadow-lg","ring-1","ring-black","ring-opacity-5","focus:outline-none","sm:text-sm"],["class","relative cursor-pointer select-none py-2 pl-3 pr-9 text-gray-900 hover:bg-blue-100",3,"click",4,"ngFor","ngForOf"],[1,"relative","cursor-pointer","select-none","py-2","pl-3","pr-9","text-gray-900","hover:bg-blue-100",3,"click"],[1,"block","truncate","font-normal"],[1,"absolute","z-50","mt-1","w-full","overflow-auto","rounded-md","bg-white","py-1","text-base","shadow-lg","ring-1","ring-black","ring-opacity-5","focus:outline-none","sm:text-sm"],[1,"relative","cursor-default","select-none","py-2","pl-3","pr-9","text-gray-500"]],template:function(t,o){t&1&&(i(0,"div",0),d(1,$,1,0,"div",1),i(2,"div",2)(3,"input",3),p("ngModelChange",function(m){return o.onSearchChange(m)})("focus",function(){return o.isOpen.set(!0)}),s(),i(4,"div",4),C(5,"lucide-icon",5),s(),d(6,j,2,1,"ul",6)(7,B,3,0,"ul",7),s()()),t&2&&(r(),l("ngIf",o.isOpen()),r(2),l("ngModel",o.searchText()),r(2),l("img",o.icons.Search),r(),l("ngIf",o.isOpen()&&o.filteredOptions().length>0),r(),l("ngIf",o.isOpen()&&o.filteredOptions().length===0))},dependencies:[M,I,N,F,z,V,E,k,T],styles:[".dropdown-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:30;background:transparent}"]})};export{L as a};
