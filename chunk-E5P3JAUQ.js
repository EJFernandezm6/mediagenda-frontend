import{a as U}from"./chunk-N3XFOJZ7.js";import{a as j}from"./chunk-DLWRNSCF.js";import{a as Q}from"./chunk-AW3SVL6A.js";import{b as B,c as z,f as G,h as X,i as q,j as $,k as H,l as J,o as K}from"./chunk-FIV2NONW.js";import{a as R}from"./chunk-3DMKKQKT.js";import"./chunk-KX3FC5ET.js";import{$a as m,Ab as D,Gc as k,Ia as I,Ma as y,Rb as E,S,Sb as N,Sc as F,Ta as d,Ua as t,Va as i,Vb as T,Vc as V,Wa as b,X as p,Y as u,Za as w,Zc as A,_a as g,a as M,ad as O,ea as x,fd as W,gb as l,hb as C,hd as L,ib as f,id as P,lb as _,mb as v,nb as h,ta as a}from"./chunk-SWYYGHOG.js";function oe(s,o){if(s&1&&(t(0,"option",30),l(1),i()),s&2){let e=o.$implicit;d("value",e.id),a(),C(e.fullName)}}function ne(s,o){if(s&1&&(t(0,"option",30),l(1),i()),s&2){let e=o.$implicit;d("value",e.specialtyId),a(),f("",e.name," ")}}function re(s,o){if(s&1){let e=w();t(0,"tr")(1,"td",31),l(2),i(),t(3,"td",32),l(4),i(),t(5,"td",32),l(6),i(),t(7,"td",32),l(8),i(),t(9,"td",33)(10,"button",34),g("click",function(){let r=p(e).$implicit,c=m();return u(c.openEditModal(r))}),l(11," Editar"),t(12,"span",25),l(13),i()(),t(14,"button",35),g("click",function(){let r=p(e).$implicit,c=m();return u(c.delete(r))}),l(15," Desactivar"),t(16,"span",25),l(17),i()()()()}if(s&2){let e=o.$implicit,n=m();a(2),f(" ",n.getSpecialtyName(e.specialtyId)," "),a(2),f(" ",n.getDoctorName(e.doctorId)," "),a(2),f(" S/ ",e.cost," "),a(2),f(" ",e.durationMinutes," min "),a(5),f(", ",n.getSpecialtyName(e.specialtyId)),a(4),f(", ",n.getSpecialtyName(e.specialtyId))}}function le(s,o){if(s&1&&(t(0,"tr")(1,"td",36)(2,"div",37),b(3,"lucide-icon",38),t(4,"p"),l(5,"No se encontraron asignaciones que coincidan con los filtros."),i()()()()),s&2){let e=m();a(3),d("img",e.icons.Search)}}function ae(s,o){if(s&1&&(t(0,"option",30),l(1),i()),s&2){let e=o.$implicit;d("value",e.id),a(),f("",e.fullName," ")}}function se(s,o){if(s&1&&(t(0,"option",30),l(1),i()),s&2){let e=o.$implicit;d("value",e.specialtyId),a(),C(e.name)}}function ce(s,o){if(s&1){let e=w();t(0,"div",39),b(1,"div",40),t(2,"div",41)(3,"div",42)(4,"div",43)(5,"div",44)(6,"button",45),g("click",function(){p(e);let r=m();return u(r.closeModal())}),t(7,"span",25),l(8,"Cerrar"),i(),b(9,"lucide-icon",46),i()(),t(10,"div",47)(11,"div",48)(12,"h3",49),l(13),i(),t(14,"div",50)(15,"div")(16,"label",51),l(17,"Especialista"),i(),t(18,"select",52),h("ngModelChange",function(r){p(e);let c=m();return v(c.selectedDoctorId,r)||(c.selectedDoctorId=r),u(r)}),t(19,"option",53),l(20,"Seleccionar especialista"),i(),y(21,ae,2,2,"option",15),i()(),t(22,"div")(23,"label",51),l(24,"Especialidad"),i(),t(25,"select",52),h("ngModelChange",function(r){p(e);let c=m();return v(c.selectedSpecialtyId,r)||(c.selectedSpecialtyId=r),u(r)}),t(26,"option",53),l(27,"Seleccionar especialidad"),i(),y(28,se,2,2,"option",15),i()(),t(29,"div",54)(30,"div")(31,"label",51),l(32,"Costo (S/)"),i(),t(33,"input",55),h("ngModelChange",function(r){p(e);let c=m();return v(c.cost,r)||(c.cost=r),u(r)}),i()(),t(34,"div")(35,"label",51),l(36,"Duraci\xF3n (min)"),i(),t(37,"input",56),h("ngModelChange",function(r){p(e);let c=m();return v(c.duration,r)||(c.duration=r),u(r)}),i()()()()()(),t(38,"div",57)(39,"button",58),g("click",function(){p(e);let r=m();return u(r.save())}),l(40," Guardar "),i(),t(41,"button",59),g("click",function(){p(e);let r=m();return u(r.closeModal())}),l(42," Cancelar "),i()()()()()()}if(s&2){let e=m();a(9),d("img",e.icons.X),a(4),f(" ",e.isEditMode()?"Editar asignaci\xF3n":"Nueva asignaci\xF3n"," "),a(5),_("ngModel",e.selectedDoctorId),d("disabled",e.isEditMode()),a(3),d("ngForOf",e.doctors()),a(4),_("ngModel",e.selectedSpecialtyId),d("disabled",e.isEditMode()),a(3),d("ngForOf",e.specialties()),a(5),_("ngModel",e.cost),a(4),_("ngModel",e.duration),a(2),d("disabled",!e.selectedDoctorId||!e.selectedSpecialtyId)}}var Y=class s{associationService=S(U);doctorService=S(R);specialtyService=S(Q);confirmService=S(j);icons={Plus:F,Trash2:O,Edit:A,Search:V,X:W,Filter:k};doctors=this.doctorService.doctors;specialties=this.specialtyService.specialties;associations=this.associationService.associations;searchTerm=x("");filterDoctorId=x("");filterSpecialtyId=x("");isModalOpen=x(!1);isEditMode=x(!1);selectedDoctorId="";selectedSpecialtyId="";cost=0;duration=30;originalAssociation=null;filteredAssociations=D(()=>{let o=this.searchTerm().toLowerCase(),e=this.filterDoctorId(),n=this.filterSpecialtyId();return this.associations().filter(r=>{let c=this.getDoctorName(r.doctorId).toLowerCase(),Z=this.getSpecialtyName(r.specialtyId).toLowerCase(),ee=c.includes(o)||Z.includes(o),te=!e||r.doctorId===e,ie=!n||r.specialtyId===n;return ee&&te&&ie})});getDoctorName(o){return this.doctors().find(e=>e.id===o)?.fullName||"Desconocido"}getSpecialtyName(o){return this.specialties().find(e=>e.specialtyId===o)?.name||"Desconocida"}openAddModal(){this.isEditMode.set(!1),this.resetForm(),this.isModalOpen.set(!0)}openEditModal(o){this.isEditMode.set(!0),this.selectedDoctorId=o.doctorId,this.selectedSpecialtyId=o.specialtyId,this.cost=o.cost,this.duration=o.durationMinutes,this.originalAssociation=M({},o),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.resetForm(),this.originalAssociation=null}save(){if(!this.selectedDoctorId||!this.selectedSpecialtyId)return;let o={doctorId:this.selectedDoctorId,specialtyId:this.selectedSpecialtyId,cost:this.cost,durationMinutes:this.duration};if(this.isEditMode()&&this.originalAssociation?.doctorSpecialtyId)this.associationService.updateAssociation(this.originalAssociation.doctorSpecialtyId,o).subscribe(()=>{this.closeModal()});else{if(this.associations().some(n=>n.doctorId===o.doctorId&&n.specialtyId===o.specialtyId)){alert("Esta asignaci\xF3n ya existe.");return}this.associationService.addAssociation(this.selectedDoctorId,o).subscribe(()=>{this.closeModal()})}}async delete(o){if(!o.doctorSpecialtyId)return;await this.confirmService.confirm({title:"Eliminar Asignaci\xF3n",message:`\xBFEst\xE1s seguro de eliminar la asignaci\xF3n de ${this.getSpecialtyName(o.specialtyId)} a ${this.getDoctorName(o.doctorId)}?`,confirmText:"Eliminar",cancelText:"Cancelar"})&&this.associationService.removeAssociation(o.doctorSpecialtyId).subscribe()}resetForm(){this.selectedDoctorId="",this.selectedSpecialtyId="",this.cost=0,this.duration=30}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=I({type:s,selectors:[["app-doctor-specialty"]],decls:48,vars:10,consts:[[1,"px-4","py-6","sm:px-6","lg:px-8"],[1,"sm:flex","sm:items-center"],[1,"sm:flex-auto"],[1,"text-xl","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-700"],[1,"mt-4","sm:mt-0","sm:ml-16","sm:flex-none"],[1,"inline-flex","items-center","justify-center","rounded-md","border","border-transparent","bg-blue-600","px-4","py-2","text-sm","font-medium","text-white","shadow-sm","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","sm:w-auto","gap-2",3,"click"],[1,"w-4","h-4",3,"img"],[1,"mt-8","bg-white","p-4","rounded-lg","shadow-sm","border","border-gray-200","grid","grid-cols-1","gap-4","md:grid-cols-4"],[1,"relative","rounded-md","shadow-sm"],[1,"pointer-events-none","absolute","inset-y-0","left-0","flex","items-center","pl-3"],[1,"h-5","w-5","text-gray-400",3,"img"],["type","text","placeholder","Buscar especialista o especialidad...",1,"block","w-full","rounded-md","border-gray-300","pl-10","focus:border-blue-500","focus:ring-blue-500","sm:text-sm","border","py-2",3,"ngModelChange","ngModel"],[1,"block","w-full","rounded-md","border-gray-300","py-2","pl-3","pr-10","text-base","focus:border-blue-500","focus:outline-none","focus:ring-blue-500","sm:text-sm","border",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"mt-8","flex","flex-col"],[1,"-my-2","-mx-4","overflow-x-auto","sm:-mx-6","lg:-mx-8"],[1,"inline-block","min-w-full","py-2","align-middle","md:px-6","lg:px-8"],[1,"overflow-hidden","shadow","ring-1","ring-black","ring-opacity-5","md:rounded-lg"],[1,"min-w-full","divide-y","divide-gray-300"],[1,"bg-gray-50"],["scope","col",1,"py-3.5","pl-4","pr-3","text-left","text-sm","font-semibold","text-gray-900","sm:pl-6"],["scope","col",1,"px-3","py-3.5","text-left","text-sm","font-semibold","text-gray-900"],["scope","col",1,"relative","py-3.5","pl-3","pr-4","sm:pr-6"],[1,"sr-only"],[1,"divide-y","divide-gray-200","bg-white"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","relative z-10","aria-labelledby","modal-title","role","dialog","aria-modal","true",4,"ngIf"],[3,"value"],[1,"whitespace-nowrap","py-4","pl-4","pr-3","text-sm","font-medium","text-gray-900","sm:pl-6"],[1,"whitespace-nowrap","px-3","py-4","text-sm","text-gray-500"],[1,"relative","whitespace-nowrap","py-4","pl-3","pr-4","text-right","text-sm","font-medium","sm:pr-6"],[1,"text-blue-600","hover:text-blue-900","mr-4","inline-flex","items-center","gap-1","transition-colors",3,"click"],[1,"text-red-600","hover:text-red-900","inline-flex","items-center","gap-1","transition-colors",3,"click"],["colspan","5",1,"px-6","py-10","text-center","text-sm","text-gray-500"],[1,"flex","flex-col","items-center","justify-center"],[1,"h-10","w-10","text-gray-300","mb-2",3,"img"],["aria-labelledby","modal-title","role","dialog","aria-modal","true",1,"relative","z-10"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity"],[1,"fixed","inset-0","z-10","overflow-y-auto"],[1,"flex","min-h-full","items-end","justify-center","p-4","text-center","sm:items-center","sm:p-0"],[1,"relative","transform","overflow-hidden","rounded-lg","bg-white","px-4","pt-5","pb-4","text-left","shadow-xl","transition-all","sm:my-8","sm:w-full","sm:max-w-lg","sm:p-6"],[1,"absolute","top-0","right-0","hidden","pt-4","pr-4","sm:block"],["type","button",1,"rounded-md","bg-white","text-gray-400","hover:text-gray-500","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2",3,"click"],[1,"h-6","w-6",3,"img"],[1,"sm:flex","sm:items-start","w-full"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],["id","modal-title",1,"text-lg","font-medium","leading-6","text-gray-900"],[1,"mt-4","space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","text-left"],[1,"mt-1","block","w-full","rounded-md","border-gray-300","py-2","pl-3","pr-10","text-base","focus:border-blue-500","focus:outline-none","focus:ring-blue-500","sm:text-sm","border","disabled:bg-gray-100","disabled:text-gray-500",3,"ngModelChange","ngModel","disabled"],["value","","disabled","","selected",""],[1,"grid","grid-cols-2","gap-4"],["type","number","min","0",1,"mt-1","block","w-full","rounded-md","border-gray-300","py-2","px-3","text-base","focus:border-blue-500","focus:outline-none","focus:ring-blue-500","sm:text-sm","border",3,"ngModelChange","ngModel"],["type","number","step","5","min","5",1,"mt-1","block","w-full","rounded-md","border-gray-300","py-2","px-3","text-base","focus:border-blue-500","focus:outline-none","focus:ring-blue-500","sm:text-sm","border",3,"ngModelChange","ngModel"],[1,"mt-5","sm:mt-4","sm:flex","sm:flex-row-reverse"],["type","button",1,"inline-flex","w-full","justify-center","rounded-md","border","border-transparent","bg-blue-600","px-4","py-2","text-base","font-medium","text-white","shadow-sm","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","sm:ml-3","sm:w-auto","sm:text-sm","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","button",1,"mt-3","inline-flex","w-full","justify-center","rounded-md","border","border-gray-300","bg-white","px-4","py-2","text-base","font-medium","text-gray-700","shadow-sm","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:ring-offset-2","sm:mt-0","sm:w-auto","sm:text-sm",3,"click"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),l(4,"Asignaci\xF3n de especialidades"),i(),t(5,"p",4),l(6,"Gestiona las especialidades asignadas a cada m\xE9dico, sus costos y duraciones."),i()(),t(7,"div",5)(8,"button",6),g("click",function(){return n.openAddModal()}),b(9,"lucide-icon",7),l(10," Nueva asignaci\xF3n "),i()()(),t(11,"div",8)(12,"div",9)(13,"div",10),b(14,"lucide-icon",11),i(),t(15,"input",12),g("ngModelChange",function(c){return n.searchTerm.set(c)}),i()(),t(16,"div")(17,"select",13),g("ngModelChange",function(c){return n.filterDoctorId.set(c)}),t(18,"option",14),l(19,"Todos los especialistas"),i(),y(20,oe,2,2,"option",15),i()(),t(21,"div")(22,"select",13),g("ngModelChange",function(c){return n.filterSpecialtyId.set(c)}),t(23,"option",14),l(24,"Todas las especialidades"),i(),y(25,ne,2,2,"option",15),i()()(),t(26,"div",16)(27,"div",17)(28,"div",18)(29,"div",19)(30,"table",20)(31,"thead",21)(32,"tr")(33,"th",22),l(34," Especialidad"),i(),t(35,"th",23),l(36," Especialista"),i(),t(37,"th",23),l(38,"Costo "),i(),t(39,"th",23),l(40," Duraci\xF3n"),i(),t(41,"th",24)(42,"span",25),l(43,"Acciones"),i()()()(),t(44,"tbody",26),y(45,re,18,6,"tr",27)(46,le,6,1,"tr",28),i()()()()()()(),y(47,ce,43,11,"div",29)),e&2&&(a(9),d("img",n.icons.Plus),a(5),d("img",n.icons.Search),a(),d("ngModel",n.searchTerm()),a(2),d("ngModel",n.filterDoctorId()),a(3),d("ngForOf",n.doctors()),a(2),d("ngModel",n.filterSpecialtyId()),a(3),d("ngForOf",n.specialties()),a(20),d("ngForOf",n.filteredAssociations()),a(),d("ngIf",n.filteredAssociations().length===0),a(),d("ngIf",n.isModalOpen()))},dependencies:[T,E,N,K,$,H,B,X,q,z,J,G,P,L],encapsulation:2})};export{Y as DoctorSpecialtyComponent};
