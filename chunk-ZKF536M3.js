import{b as F,c as L,d as V,j as W}from"./chunk-M3MBMLMX.js";import{a as j}from"./chunk-GLSC72EF.js";import{Fa as v,Fb as N,Gb as C,Ib as D,Ja as g,Pa as m,Qa as n,Ra as o,S as h,Sa as c,Va as _,Wa as p,X as x,Xa as u,Y as b,bb as A,cb as a,db as f,ea as y,eb as w,hb as E,ib as M,jb as S,pc as R,sa as l,sb as I,sc as T,tc as k,xc as P,yc as U}from"./chunk-XRB76YFL.js";function G(s,i){if(s&1&&(n(0,"div",20)(1,"div",21)(2,"div",22),c(3,"lucide-icon",23),o(),n(4,"div",24)(5,"p",25),a(6),o()()()()),s&2){let e=u();l(3),m("img",e.icons.Shield),l(3),f(e.successMessage)}}function B(s,i){s&1&&(n(0,"span",39),a(1," Admin "),o())}function H(s,i){s&1&&(n(0,"span",40),a(1," Especialista "),o())}function Q(s,i){if(s&1){let e=_();n(0,"li",26)(1,"div",27)(2,"div",28)(3,"div",29),a(4),o(),n(5,"div")(6,"h4",30),a(7),o(),n(8,"p",31),a(9),o()()(),n(10,"div",32),g(11,B,2,0,"span",33)(12,H,2,0,"span",34),c(13,"div",35),n(14,"button",36),p("click",function(){let r=x(e).$implicit,d=u();return b(d.toggleAdminRole(r))}),c(15,"lucide-icon",37),o(),n(16,"button",38),p("click",function(){let r=x(e).$implicit,d=u();return b(d.removeUser(r))}),c(17,"lucide-icon",37),o()()()()}if(s&2){let e=i.$implicit,t=u();l(4),w(" ",e.fullName.charAt(0)," "),l(3),f(e.fullName),l(2),f(e.email),l(2),m("ngIf",e.roles.includes("ADMIN")),l(),m("ngIf",e.roles.includes("ESPECIALISTA")),l(2),A(e.roles.includes("ADMIN")?"text-blue-600 bg-blue-50":"text-gray-400 hover:text-blue-600"),m("title",e.roles.includes("ADMIN")?"Quitar rol de Admin":"Hacer Admin"),l(),m("img",t.icons.Shield),l(2),m("img",t.icons.Trash2)}}var O=class s{doctorsService=h(j);icons={Shield:R,UserPlus:k,Trash2:T};admins=y([{id:"admin1",fullName:"Administrador Principal",email:"admin@mediagenda.com",role:"ADMIN"},{id:"admin2",fullName:"Gerente Cl\xEDnica",email:"gerente@mediagenda.com",role:"ADMIN"}]);usersWithRoles=I(()=>{let i=this.doctorsService.doctors(),e=this.admins(),t=new Map;return e.forEach(r=>{t.set(r.email,{id:r.id,fullName:r.fullName,email:r.email,roles:["ADMIN"],isDoctor:!1})}),i.forEach(r=>{if(t.has(r.email)){let d=t.get(r.email);d.roles.push("ESPECIALISTA"),d.isDoctor=!0,d.doctorId=r.id}else t.set(r.email,{id:r.id,fullName:r.fullName,email:r.email,roles:["ESPECIALISTA"],isDoctor:!0,doctorId:r.id})}),Array.from(t.values())});successMessage="";newAdminEmail="";addAdmin(){if(!this.newAdminEmail)return;if(this.admins().some(e=>e.email===this.newAdminEmail)){alert("Este usuario ya es administrador.");return}let i=this.doctorsService.doctors().find(e=>e.email===this.newAdminEmail);this.admins.update(e=>[...e,{id:crypto.randomUUID(),fullName:i?i.fullName:"Nuevo Administrador",email:this.newAdminEmail,role:"ADMIN"}]),this.newAdminEmail="",this.showSuccess("Administrador agregado correctamente.")}toggleAdminRole(i){i.roles.includes("ADMIN")?(this.admins.update(e=>e.filter(t=>t.email!==i.email)),this.showSuccess("Rol de administrador revocado.")):(this.admins.update(e=>[...e,{id:crypto.randomUUID(),fullName:i.fullName,email:i.email,role:"ADMIN"}]),this.showSuccess("Rol de administrador asignado."))}removeUser(i){if(confirm("\xBFEst\xE1s seguro de eliminar a este usuario?")){if(i.isDoctor){alert("Este usuario es un Especialista. Debes eliminarlo desde la secci\xF3n de Especialistas.");return}this.toggleAdminRole(i)}}showSuccess(i){this.successMessage=i,setTimeout(()=>this.successMessage="",3e3)}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=v({type:s,selectors:[["app-roles-manager"]],decls:26,vars:6,consts:[[1,"px-4","py-6","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"text-xl","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-700"],["class","mb-4 bg-green-50 border-l-4 border-green-400 p-4",4,"ngIf"],[1,"bg-white","shadow","rounded-lg","overflow-hidden","border","border-gray-100"],[1,"px-6","py-4","border-b","border-gray-100","bg-gray-50","flex","items-center","gap-2"],[1,"w-5","h-5","text-gray-500",3,"img"],[1,"text-lg","font-medium","text-gray-900"],[1,"p-6"],[1,"overflow-hidden","bg-white","border","border-gray-200","rounded-lg","mb-6"],["role","list",1,"divide-y","divide-gray-200"],["class","px-4 py-4 sm:px-6 hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"bg-gray-50","rounded-lg","p-4","border","border-gray-200"],[1,"text-sm","font-medium","text-gray-900","mb-3","flex","items-center","gap-2"],[1,"w-4","h-4","text-gray-500",3,"img"],[1,"flex","gap-2"],["type","email","placeholder","correo@ejemplo.com",1,"block","w-full","rounded-md","border-gray-300","shadow-sm","focus:border-blue-500","focus:ring-blue-500","border","px-3","py-2","text-sm",3,"ngModelChange","ngModel"],[1,"inline-flex","items-center","px-4","py-2","border","border-transparent","text-sm","font-medium","rounded-md","shadow-sm","text-white","bg-blue-600","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50","disabled:cursor-not-allowed","whitespace-nowrap",3,"click","disabled"],[1,"mt-2","text-xs","text-gray-500"],[1,"mb-4","bg-green-50","border-l-4","border-green-400","p-4"],[1,"flex"],[1,"flex-shrink-0"],[1,"h-5","w-5","text-green-400",3,"img"],[1,"ml-3"],[1,"text-sm","text-green-700"],[1,"px-4","py-4","sm:px-6","hover:bg-gray-50","transition-colors"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],[1,"h-10","w-10","rounded-full","bg-blue-100","flex","items-center","justify-center","text-blue-600","font-bold","shrink-0"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"flex","items-center","gap-3"],["class","inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",4,"ngIf"],["class","inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",4,"ngIf"],[1,"h-4","w-px","bg-gray-300","mx-1"],[1,"p-1.5","rounded-md","transition-colors","hover:bg-gray-100",3,"click","title"],[1,"w-4","h-4",3,"img"],["title","Eliminar usuario",1,"p-1.5","rounded-md","text-gray-400","hover:text-red-600","hover:bg-red-50","transition-colors",3,"click"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-blue-100","text-blue-800"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"Gesti\xF3n de Roles y Permisos"),o(),n(4,"p",3),a(5,"Administra los usuarios con acceso al sistema y sus roles asignados."),o()(),g(6,G,7,2,"div",4),n(7,"div",5)(8,"div",6),c(9,"lucide-icon",7),n(10,"h3",8),a(11,"Usuarios y Roles"),o()(),n(12,"div",9)(13,"div",10)(14,"ul",11),g(15,Q,18,10,"li",12),o()(),n(16,"div",13)(17,"h4",14),c(18,"lucide-icon",15),a(19," Invitar Administrador "),o(),n(20,"div",16)(21,"input",17),S("ngModelChange",function(d){return M(t.newAdminEmail,d)||(t.newAdminEmail=d),d}),o(),n(22,"button",18),p("click",function(){return t.addAdmin()}),a(23," Agregar "),o()(),n(24,"p",19),a(25," Si el correo ya pertenece a un especialista, se le asignar\xE1 el rol de Admin adicionalmente. "),o()()()()()),e&2&&(l(6),m("ngIf",t.successMessage),l(3),m("img",t.icons.Shield),l(6),m("ngForOf",t.usersWithRoles()),l(3),m("img",t.icons.UserPlus),l(3),E("ngModel",t.newAdminEmail),l(),m("disabled",!t.newAdminEmail))},dependencies:[D,N,C,W,F,L,V,U,P],encapsulation:2})};export{O as RolesManagerComponent};
