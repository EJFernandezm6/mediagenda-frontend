import{a as U}from"./chunk-MOKWQR56.js";import{a as Q}from"./chunk-GRNV4ZS6.js";import{b as P,c as z,d as B,f as J,g as G,h as R,j as q}from"./chunk-RWTD4LR5.js";import{a as H}from"./chunk-BDBARYAH.js";import{a as K}from"./chunk-FMLYNP3Z.js";import{Ab as V,Bb as N,Fb as O,Ga as F,Ka as g,Qa as c,Ra as o,S as h,Sa as n,Ta as v,Tb as W,Wa as _,X as u,Xa as f,Y as p,Ya as m,db as d,eb as x,ec as j,fa as k,fb as S,gb as I,ib as C,jb as w,kb as D,kc as L,oc as A,pb as T,pc as $,ta as a}from"./chunk-GRSUPIB2.js";function Y(l,i){if(l&1&&(o(0,"option",23),d(1),n()),l&2){let e=i.$implicit;c("value",e.id),a(),x(e.fullName)}}function Z(l,i){if(l&1){let e=_();o(0,"li",24)(1,"div")(2,"span",25),d(3),n(),o(4,"span",26),d(5),n(),o(6,"span",27),d(7),n()(),o(8,"button",28),f("click",function(){let r=u(e).$implicit,s=m();return p(s.remove(r))}),v(9,"lucide-icon",29),n()()}if(l&2){let e=i.$implicit,t=m();a(3),x(t.getDayName(e.dayOfWeek)),a(2),I("",e.startTime," - ",e.endTime),a(2),x(t.getSpecialtyName(e.specialtyId)),a(2),c("img",t.icons.Trash2)}}function ee(l,i){l&1&&(o(0,"li",30),d(1," No hay turnos asignados. Haz clic en el calendario para agregar. "),n())}function te(l,i){if(l&1&&(o(0,"div",31),v(1,"lucide-icon",32),o(2,"p",33),d(3,"Selecciona un m\xE9dico para gestionar su agenda"),n()()),l&2){let e=m();a(),c("img",e.icons.Clock)}}function ie(l,i){if(l&1&&(o(0,"div",41)(1,"div",42),d(2),n(),o(3,"div",43),d(4),n()()),l&2){let e=i.$implicit;a(2),x(e.name),a(2),x(e.dateLabel)}}function ne(l,i){if(l&1&&(o(0,"div",49)(1,"span",50),d(2),n(),o(3,"span",51),d(4),n()()),l&2){let e=i.ngIf,t=m(4);c("title",e.startTime+" - "+e.endTime+" ("+t.getSpecialtyName(e.specialtyId)+")"),a(2),x(t.getSpecialtyName(e.specialtyId)),a(2),I("",e.startTime," - ",e.endTime)}}function oe(l,i){if(l&1){let e=_();o(0,"div",47),f("click",function(){let r=u(e).$implicit,s=m().$implicit,b=m(2);return p(b.onSlotClick(r.id,s))}),g(1,ne,5,4,"div",48),n()}if(l&2){let e=i.$implicit,t=m().$implicit,r=m(2);a(),c("ngIf",r.getScheduleForSlot(e.id,t))}}function re(l,i){if(l&1&&(o(0,"div",44)(1,"div",45),d(2),n(),g(3,oe,2,1,"div",46),n()),l&2){let e=i.$implicit,t=m(2);a(2),S(" ",e," "),a(),c("ngForOf",t.weekDays())}}function le(l,i){if(l&1&&(o(0,"div",34)(1,"div",35)(2,"div",36)(3,"div",37),d(4," Hora"),n(),g(5,ie,5,2,"div",38),n(),o(6,"div",39),g(7,re,4,2,"div",40),n()()()),l&2){let e=m();a(5),c("ngForOf",e.weekDays()),a(2),c("ngForOf",e.timeSlots)}}function ae(l,i){if(l&1&&(o(0,"option",23),d(1),n()),l&2){let e=i.$implicit;c("value",e.id),a(),x(e.name)}}function de(l,i){if(l&1){let e=_();o(0,"div",52)(1,"div",53)(2,"div",54),f("click",function(){u(e);let r=m();return p(r.closeModal())}),n(),o(3,"span",55),d(4,"\u200B"),n(),o(5,"div",56)(6,"div",57)(7,"button",58),f("click",function(){u(e);let r=m();return p(r.closeModal())}),o(8,"span",59),d(9,"Cerrar"),n(),v(10,"lucide-icon",60),n()(),o(11,"div",61)(12,"div",62),v(13,"lucide-icon",63),n(),o(14,"div",64)(15,"h3",65),d(16,"Asignar Turno de Atenci\xF3n"),n(),o(17,"div",66)(18,"div",67)(19,"span")(20,"strong"),d(21,"D\xEDa:"),n(),d(22),n(),o(23,"span")(24,"strong"),d(25,"Inicio:"),n(),d(26),n()(),o(27,"div")(28,"label",9),d(29,"Especialidad"),n(),o(30,"select",68),D("ngModelChange",function(r){u(e);let s=m();return w(s.modalData.specialtyId,r)||(s.modalData.specialtyId=r),p(r)}),g(31,ae,2,2,"option",12),n()(),o(32,"div",69)(33,"div")(34,"label",9),d(35,"Hora Inicio"),n(),o(36,"input",70),D("ngModelChange",function(r){u(e);let s=m();return w(s.modalData.startTime,r)||(s.modalData.startTime=r),p(r)}),f("ngModelChange",function(){u(e);let r=m();return p(r.onStartTimeChange())}),n()(),o(37,"div")(38,"label",9),d(39,"Hora Fin"),n(),o(40,"input",70),D("ngModelChange",function(r){u(e);let s=m();return w(s.modalData.endTime,r)||(s.modalData.endTime=r),p(r)}),n()()()()()(),o(41,"div",71)(42,"button",72),f("click",function(){u(e);let r=m();return p(r.saveSchedule())}),d(43," Guardar Turno "),n(),o(44,"button",73),f("click",function(){u(e);let r=m();return p(r.closeModal())}),d(45," Cancelar "),n()()()()()}if(l&2){let e=m();a(10),c("img",e.icons.Plus),a(3),c("img",e.icons.Clock),a(9),S(" ",e.getDayName(e.modalData.dayOfWeek)),a(4),S(" ",e.modalData.startTime),a(4),C("ngModel",e.modalData.specialtyId),a(),c("ngForOf",e.availableSpecialtiesForDoctor),a(5),C("ngModel",e.modalData.startTime),a(4),C("ngModel",e.modalData.endTime)}}var X=class l{scheduleService=h(U);doctorService=h(K);specialtyService=h(H);associationService=h(Q);icons={Clock:W,Plus:j,Trash2:L};doctors=T(()=>{let i=this.doctorService.doctors(),e=this.associationService.associations();return i.filter(t=>e.some(r=>r.doctorId===t.id))});selectedDoctorId=k("");currentSchedules=T(()=>{let i=this.selectedDoctorId();return i?this.scheduleService.schedules().filter(t=>t.doctorId===i):[]});weekDays=T(()=>{let i=new Date,e=i.getDay(),t=i.getDate()-e+(e===0?-6:1),r=new Date(i.setDate(t)),s=[],b=["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"];for(let y=1;y<=6;y++){let M=new Date(r);M.setDate(r.getDate()+(y-1)),s.push({id:y,name:b[y],dateLabel:M.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})})}let E=new Date(r);return E.setDate(r.getDate()+6),s.push({id:0,name:b[0],dateLabel:E.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})}),s});isModalOpen=!1;modalData={dayOfWeek:1,startTime:"09:00",endTime:"09:30",specialtyId:""};viewMode="calendar";timeSlots=Array.from({length:26},(i,e)=>{let t=420+e*30,r=Math.floor(t/60),s=t%60;return`${r.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`});get availableSpecialtiesForDoctor(){let i=this.selectedDoctorId();return i?this.associationService.getSpecialtiesForDoctor(i).map(t=>this.specialtyService.specialties().find(r=>r.id===t.specialtyId)).filter(t=>!!t):[]}getDayName(i){return[{id:1,name:"Lunes"},{id:2,name:"Martes"},{id:3,name:"Mi\xE9rcoles"},{id:4,name:"Jueves"},{id:5,name:"Viernes"},{id:6,name:"S\xE1bado"},{id:0,name:"Domingo"}].find(t=>t.id===i)?.name||"Desconocido"}getSpecialtyName(i){return this.specialtyService.specialties().find(e=>e.id===i)?.name||""}onStartTimeChange(){this.modalData.startTime&&(this.modalData.endTime=this.addMinutes(this.modalData.startTime,30))}getScheduleForSlot(i,e){return this.currentSchedules().find(t=>t.dayOfWeek===i&&e>=t.startTime&&e<t.endTime)}onSlotClick(i,e){!this.selectedDoctorId()||this.getScheduleForSlot(i,e)||(this.modalData={dayOfWeek:i,startTime:e,endTime:this.addMinutes(e,30),specialtyId:this.availableSpecialtiesForDoctor[0]?.id||""},this.isModalOpen=!0)}saveSchedule(){let i=this.selectedDoctorId();i&&this.modalData.specialtyId&&(this.scheduleService.addSchedule({doctorId:i,specialtyId:this.modalData.specialtyId,dayOfWeek:this.modalData.dayOfWeek,startTime:this.modalData.startTime,endTime:this.modalData.endTime}),this.closeModal())}closeModal(){this.isModalOpen=!1}remove(i){this.scheduleService.removeSchedule(i)}addMinutes(i,e){let[t,r]=i.split(":").map(Number),s=new Date;return s.setHours(t,r+e),`${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}`}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=F({type:l,selectors:[["app-schedule-config"]],decls:30,vars:7,consts:[[1,"px-4","py-6","sm:px-6","lg:px-8"],[1,"mb-8"],[1,"text-xl","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-700"],[1,"grid","grid-cols-1","lg:grid-cols-4","gap-8","h-[calc(100vh-140px)]"],[1,"lg:col-span-1","flex","flex-col","gap-6"],[1,"bg-white","shadow","rounded-lg","p-6","border","border-gray-100"],[1,"text-lg","font-medium","leading-6","text-gray-900","mb-4"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-700"],[1,"mt-1","block","w-full","rounded-md","border-gray-300","py-2","pl-3","pr-10","text-base","focus:border-blue-500","focus:outline-none","focus:ring-blue-500","sm:text-sm","border",3,"ngModelChange","ngModel"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"bg-white","shadow","rounded-lg","overflow-hidden","border","border-gray-100","flex-1","overflow-y-auto"],[1,"px-4","py-3","border-b","border-gray-200","bg-gray-50"],[1,"text-sm","font-medium","leading-6","text-gray-900"],["role","list",1,"divide-y","divide-gray-200"],["class","px-4 py-3 hover:bg-gray-50 flex justify-between items-center text-sm",4,"ngFor","ngForOf"],["class","px-4 py-8 text-center text-gray-400 text-xs",4,"ngIf"],[1,"lg:col-span-3","bg-white","shadow","rounded-lg","border","border-gray-100","flex","flex-col","h-full","overflow-hidden"],["class","flex flex-col items-center justify-center h-full text-gray-400 bg-gray-50",4,"ngIf"],["class","flex-1 overflow-auto relative",4,"ngIf"],["class","fixed inset-0 z-50 overflow-y-auto","aria-labelledby","modal-title","role","dialog","aria-modal","true",4,"ngIf"],[3,"value"],[1,"px-4","py-3","hover:bg-gray-50","flex","justify-between","items-center","text-sm"],[1,"font-bold","text-gray-900","block"],[1,"text-gray-500"],[1,"block","text-xs","text-blue-600","font-medium"],[1,"text-gray-400","hover:text-red-600",3,"click"],[1,"w-4","h-4",3,"img"],[1,"px-4","py-8","text-center","text-gray-400","text-xs"],[1,"flex","flex-col","items-center","justify-center","h-full","text-gray-400","bg-gray-50"],[1,"w-16","h-16","mb-4","opacity-50",3,"img"],[1,"text-lg","font-medium"],[1,"flex-1","overflow-auto","relative"],[1,"min-w-[800px]","h-full","flex","flex-col"],[1,"grid","grid-cols-8","border-b","border-gray-200","bg-gray-50","sticky","top-0","z-10","shadow-sm"],[1,"p-3","text-xs","font-semibold","text-gray-400","text-center","border-r","border-gray-200","flex","items-center","justify-center"],["class","p-2 text-center border-r border-gray-200 last:border-r-0",4,"ngFor","ngForOf"],[1,"flex-1","relative"],["class","grid grid-cols-8 h-12 border-b border-gray-100 hover:bg-gray-50/50 transition-colors group",4,"ngFor","ngForOf"],[1,"p-2","text-center","border-r","border-gray-200","last:border-r-0"],[1,"text-xs","font-bold","text-gray-700","uppercase","tracking-wide"],[1,"text-[10px]","text-gray-500","font-mono","mt-0.5"],[1,"grid","grid-cols-8","h-12","border-b","border-gray-100","hover:bg-gray-50/50","transition-colors","group"],[1,"p-1","px-2","text-xs","text-gray-500","text-right","border-r","border-gray-200","bg-gray-50","flex","items-center","justify-end","font-mono"],["class","border-r border-gray-100 last:border-r-0 relative cursor-pointer hover:bg-blue-50 transition-colors p-0.5",3,"click",4,"ngFor","ngForOf"],[1,"border-r","border-gray-100","last:border-r-0","relative","cursor-pointer","hover:bg-blue-50","transition-colors","p-0.5",3,"click"],["class","w-full h-full bg-blue-600 rounded text-white text-[10px] flex flex-col items-center justify-center shadow-sm overflow-hidden p-1 leading-tight hover:bg-blue-700 transition-colors",3,"title",4,"ngIf"],[1,"w-full","h-full","bg-blue-600","rounded","text-white","text-[10px]","flex","flex-col","items-center","justify-center","shadow-sm","overflow-hidden","p-1","leading-tight","hover:bg-blue-700","transition-colors",3,"title"],[1,"font-bold","truncate","w-full","text-center"],[1,"opacity-90"],["aria-labelledby","modal-title","role","dialog","aria-modal","true",1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-end","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],["aria-hidden","true",1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"relative","inline-block","align-bottom","bg-white","rounded-lg","px-4","pt-5","pb-4","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-lg","sm:w-full","sm:p-6"],[1,"absolute","top-0","right-0","pt-4","pr-4"],["type","button",1,"bg-white","rounded-md","text-gray-400","hover:text-gray-500","focus:outline-none",3,"click"],[1,"sr-only"],[1,"w-6","h-6","rotate-45",3,"img"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-blue-100","sm:mx-0","sm:h-10","sm:w-10"],[1,"h-6","w-6","text-blue-600",3,"img"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left","w-full"],["id","modal-title",1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-4","space-y-4"],[1,"bg-gray-50","p-3","rounded-md","text-sm","text-gray-600","flex","gap-4"],[1,"mt-1","block","w-full","pl-3","pr-10","py-2","text-base","border-gray-300","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","sm:text-sm","rounded-md","border",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-2","gap-4"],["type","time",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","sm:text-sm",3,"ngModelChange","ngModel"],[1,"mt-5","sm:mt-4","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-blue-600","text-base","font-medium","text-white","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:ml-3","sm:w-auto","sm:text-sm",3,"click"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","sm:mt-0","sm:w-auto","sm:text-sm",3,"click"]],template:function(e,t){e&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"Turnos de Atenci\xF3n"),n(),o(4,"p",3),d(5,"Define los d\xEDas y horas de atenci\xF3n por m\xE9dico y especialidad."),n()(),o(6,"div",4)(7,"div",5)(8,"div",6)(9,"h3",7),d(10,"Seleccionar Contexto"),n(),o(11,"div",8)(12,"div")(13,"label",9),d(14,"M\xE9dico"),n(),o(15,"select",10),f("ngModelChange",function(s){return t.selectedDoctorId.set(s)}),o(16,"option",11),d(17,"Seleccionar m\xE9dico"),n(),g(18,Y,2,2,"option",12),n()()()(),o(19,"div",13)(20,"div",14)(21,"h3",15),d(22,"Resumen de Turnos"),n()(),o(23,"ul",16),g(24,Z,10,5,"li",17)(25,ee,2,0,"li",18),n()()(),o(26,"div",19),g(27,te,4,1,"div",20)(28,le,8,2,"div",21),n()(),g(29,de,46,8,"div",22),n()),e&2&&(a(15),c("ngModel",t.selectedDoctorId()),a(3),c("ngForOf",t.doctors()),a(6),c("ngForOf",t.currentSchedules()),a(),c("ngIf",t.currentSchedules().length===0),a(2),c("ngIf",!t.selectedDoctorId()),a(),c("ngIf",t.selectedDoctorId()),a(),c("ngIf",t.isModalOpen))},dependencies:[O,V,N,q,G,R,P,J,z,B,$,A],encapsulation:2})};export{X as ScheduleConfigComponent};
