import{a as Se}from"./chunk-DQI4QRFZ.js";import{a as we}from"./chunk-XIIY2O6X.js";import{a as Ce}from"./chunk-R3C6KUGD.js";import{a as Ie}from"./chunk-BLA25NNT.js";import{a as he}from"./chunk-7PGC4CCZ.js";import{b as _e,c as ge,f as ue,i as xe,j as fe,k as be,o as ve}from"./chunk-HT5T4W3C.js";import{a as ye}from"./chunk-KFKJMQGU.js";import{a as me}from"./chunk-MZ3EZVY4.js";import{$ as u,$a as s,Aa as o,Bd as ce,Cd as pe,Gb as G,Gc as ee,Hb as U,Jc as te,Kc as ne,Mc as ie,N as R,Nc as oe,Ob as N,Pb as W,Pc as ae,Qa as H,R as z,Rc as re,Ua as m,W as k,a as O,aa as x,ab as r,b as j,bb as l,cb as g,db as E,eb as D,ec as Y,fc as q,gb as w,gc as J,hb as _,ia as C,ib as c,ic as K,kc as Q,kd as le,nd as se,sb as h,sc as X,tb as d,tc as Z,ub as f,vb as S,wb as $,xb as B,xd as de}from"./chunk-XATCTO35.js";var L=class n{http=k(Z);apiUrl=`${me.apiUrl}/appointments`;appointments=C([]);normalizeTime(t){return t&&t.length>5?t.substring(0,5):t}normalizeAppointment(t){return j(O({},t),{startTime:this.normalizeTime(t.startTime),endTime:this.normalizeTime(t.endTime)})}refreshAppointmentsByRange(t,e){let i=new X().set("from",t).set("to",e);this.http.get(`${this.apiUrl}/range`,{params:i}).subscribe(a=>{this.appointments.set(a.map(p=>this.normalizeAppointment(p)))})}addAppointment(t){return this.http.post(this.apiUrl,t).pipe(R(e=>this.appointments.update(i=>[...i,this.normalizeAppointment(e)])))}updatestatus(t,e){this.http.put(`${this.apiUrl}/${t}/status`,{status:e}).subscribe(i=>{this.appointments.update(a=>a.map(p=>p.appointmentId===t?this.normalizeAppointment(i):p))})}cancelAppointment(t){this.updatestatus(t,"CANCELLED")}static \u0275fac=function(e){return new(e||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})};function De(n,t){if(n&1&&(r(0,"option",26),d(1),l()),n&2){let e=t.$implicit;s("value",e.specialtyId),o(),f(e.name)}}function Me(n,t){if(n&1&&(E(0),r(1,"span",27),d(2),l(),r(3,"span",28),d(4),l(),D()),n&2){let e=c();o(2),B(" ",e.weekDays()[0].dayNum," ",e.weekDays()[0].monthName," - ",e.weekDays()[6].dayNum," ",e.weekDays()[6].monthName," "),o(2),S(" ",e.weekDays()[0].date.getFullYear()," ")}}function ke(n,t){if(n&1&&(E(0),r(1,"span",29),d(2),G(3,"titlecase"),l(),D()),n&2){let e=c();o(2),S(" ",U(3,1,e.currentDateStr())," ")}}function Te(n,t){if(n&1&&(r(0,"div",31)(1,"p",32),d(2),l(),r(3,"div",33)(4,"span",34),d(5),l(),r(6,"span",35),d(7),l()()()),n&2){let e=t.$implicit;o(2),f(e.dayName),o(3),f(e.dayNum),o(2),f(e.monthName)}}function Ne(n,t){if(n&1&&(E(0),m(1,Te,8,3,"div",30),D()),n&2){let e=c();o(),s("ngForOf",e.weekDays())}}function Pe(n,t){if(n&1&&(E(0),r(1,"div",36)(2,"p",37),d(3),l()(),D()),n&2){let e=c();o(3),f(e.currentDateStr())}}function Ve(n,t){n&1&&g(0,"div",44)}function Fe(n,t){if(n&1&&(E(0),r(1,"span"),d(2),l(),r(3,"span",51),d(4),l(),D()),n&2){let e=c(2).$implicit,i=c(5);o(),h(e.isPast?"text-[9px] font-medium truncate w-full text-center":"text-[9px] font-medium text-blue-600 truncate w-full text-center"),o(),f(e.doctorName),o(2),f(i.getSpecialtyName(e.specialtyId))}}function Oe(n,t){if(n&1&&g(0,"lucide-icon",52),n&2){let e=c(7);s("img",e.icons.Plus)}}function je(n,t){if(n&1){let e=w();r(0,"button",47),_("click",function(){u(e);let a=c().$implicit,p=c(2).$implicit,y=c(2).$implicit,b=c();return x(!a.isPast&&b.openBookingModal(p.iso,y,a.doctorId,a.specialtyId))}),m(1,Fe,5,4,"ng-container",16)(2,Oe,1,1,"lucide-icon",48),r(3,"div",49)(4,"div"),d(5),l(),r(6,"div",50),d(7),l()()()}if(n&2){let e=c().$implicit,i=c().ngIf,a=c(4);s("disabled",e.isPast)("ngClass",(i.length>=3?"w-8 h-8 p-0 justify-center ":"w-full min-h-[30px] p-0.5 ")+(e.isPast?"opacity-100 cursor-not-allowed bg-gray-200 border-gray-300 border-dashed text-gray-500":"cursor-pointer hover:bg-blue-100 hover:border-solid hover:shadow-md bg-blue-50 border-blue-200 border-dashed")),o(),s("ngIf",i.length<3),o(),s("ngIf",i.length>=3),o(3),f(e.doctorName),o(2),f(a.getSpecialtyName(e.specialtyId))}}function $e(n,t){if(n&1&&(E(0),r(1,"div",57),d(2),l(),r(3,"div",58),d(4),l(),D()),n&2){let e=c(2).$implicit,i=c(5);o(2),f(e.appointment.patientName),o(2),f(i.getDoctorName(e.appointment.doctorId))}}function Le(n,t){if(n&1&&g(0,"lucide-icon",63),n&2){let e=c(8);s("img",e.icons.CheckCircle)}}function Re(n,t){if(n&1&&g(0,"lucide-icon",64),n&2){let e=c(8);s("img",e.icons.HelpCircle)}}function ze(n,t){if(n&1&&(r(0,"div",65),d(1),l()),n&2){let e=c(3).$implicit;o(),S(" ",e.appointment.patientName.charAt(0)," ")}}function He(n,t){if(n&1&&(r(0,"div",59),m(1,Le,1,1,"lucide-icon",60)(2,Re,1,1,"lucide-icon",61)(3,ze,2,1,"div",62),l()),n&2){let e=c(2).$implicit;o(),s("ngIf",e.appointment.paymentStatus==="PAID"),o(),s("ngIf",e.appointment.status==="CONFIRMED"&&e.appointment.paymentStatus==="PENDING"),o(),s("ngIf",e.appointment.paymentStatus!=="PAID"&&!(e.appointment.status==="CONFIRMED"&&e.appointment.paymentStatus==="PENDING"))}}function Be(n,t){if(n&1){let e=w();r(0,"button",53),_("click",function(a){u(e);let p=c().$implicit;return c(5).openAppointmentDetails(p.appointment),x(a.stopPropagation())}),m(1,$e,5,2,"ng-container",16)(2,He,4,3,"div",54),r(3,"div",55)(4,"div",56),d(5),l(),r(6,"div"),d(7),l(),r(8,"div",50),d(9),l()()()}if(n&2){let e=c().$implicit,i=c().ngIf,a=c(4);h("rounded border-l-4 shadow-sm cursor-pointer hover:shadow-md transition-all relative group flex flex-col justify-center "+a.getAppointmentColorClass(e.appointment)),s("ngClass",i.length>=3?"w-8 h-8 p-0 justify-center items-center":"w-full min-h-[40px] p-1.5 text-left"),o(),s("ngIf",i.length<3),o(),s("ngIf",i.length>=3),o(3),f(e.appointment.patientName),o(2),f(a.getDoctorName(e.appointment.doctorId)),o(2),f(a.getAppointmentStatusLabel(e.appointment))}}function Ge(n,t){if(n&1&&(E(0),m(1,je,8,6,"button",45)(2,Be,10,8,"button",46),D()),n&2){let e=t.$implicit;o(),s("ngIf",e.type==="available"),o(),s("ngIf",e.type==="booked")}}function Ue(n,t){if(n&1&&(E(0),m(1,Ve,1,0,"div",41),r(2,"div",42),m(3,Ge,3,2,"ng-container",43),l(),D()),n&2){let e=t.ngIf;o(),s("ngIf",e.length===0),o(),s("ngClass",e.length>=3?"flex flex-row flex-wrap content-start gap-1 p-1":"flex flex-col gap-1"),o(),s("ngForOf",e)}}function We(n,t){if(n&1&&(r(0,"div"),m(1,Ue,4,3,"ng-container",16),l()),n&2){let e=t.$implicit,i=t.index,a=c(2).$implicit,p=c();h((!p.isWorkingDay(i)||p.isPastDate(e.iso)?"bg-gray-100/70 ":"")+"border-r border-gray-100 last:border-r-0 relative p-1 min-h-[3.5rem]"),o(),s("ngIf",p.getSlotStatus(e.iso,a,i))}}function Ye(n,t){if(n&1&&(E(0),m(1,We,2,3,"div",40),D()),n&2){let e=c(2);o(),s("ngForOf",e.weekDays())}}function qe(n,t){n&1&&g(0,"div",68)}function Je(n,t){if(n&1&&(r(0,"div",74)(1,"div",75),d(2),l(),r(3,"div",76),d(4),l()()),n&2){let e=c(2).$implicit,i=c(4);o(2),S(" ",e.doctorName),o(2),f(i.getSpecialtyName(e.specialtyId))}}function Ke(n,t){if(n&1&&(r(0,"div",77),g(1,"lucide-icon",78),l()),n&2){let e=c(6);o(),s("img",e.icons.Plus)}}function Qe(n,t){if(n&1&&g(0,"lucide-icon",52),n&2){let e=c(6);s("img",e.icons.Plus)}}function Xe(n,t){if(n&1){let e=w();r(0,"button",70),_("click",function(){u(e);let a=c().$implicit,p=c(3).$implicit,y=c();return x(y.openBookingModal(y.currentDate().toISOString().split("T")[0],p,a.doctorId,a.specialtyId))}),m(1,Je,5,2,"div",71)(2,Ke,2,1,"div",72)(3,Qe,1,1,"lucide-icon",48),r(4,"div",73)(5,"div"),d(6),l(),r(7,"div",50),d(8),l()()()}if(n&2){let e=c().$implicit,i=c().ngIf,a=c(3);s("ngClass",i.length>=3?"w-8 h-8 p-0 justify-center":"flex-1 p-2 justify-between min-w-[140px]"),o(),s("ngIf",i.length<3),o(),s("ngIf",i.length<3),o(),s("ngIf",i.length>=3),o(3),f(e.doctorName),o(2),f(a.getSpecialtyName(e.specialtyId))}}function Ze(n,t){if(n&1&&(r(0,"div",81)(1,"div",82),d(2),l(),r(3,"div",83),d(4),l()()),n&2){let e=c(2).$implicit,i=c(4);o(2),S("",e.appointment.patientName," "),o(2),f(i.getDoctorName(e.appointment.doctorId))}}function et(n,t){if(n&1&&g(0,"lucide-icon",63),n&2){let e=c(7);s("img",e.icons.CheckCircle)}}function tt(n,t){if(n&1&&g(0,"lucide-icon",64),n&2){let e=c(7);s("img",e.icons.HelpCircle)}}function nt(n,t){if(n&1&&(r(0,"div",85),d(1),l()),n&2){let e,i=c(3).$implicit;o(),$(" ",i.appointment.patientName.charAt(0),"",((e=i.appointment.patientName.split(" ")[1])==null?null:e.charAt(0))||""," ")}}function it(n,t){if(n&1&&(r(0,"div",59),m(1,et,1,1,"lucide-icon",60)(2,tt,1,1,"lucide-icon",61)(3,nt,2,2,"div",84),l()),n&2){let e=c(2).$implicit;o(),s("ngIf",e.appointment.paymentStatus==="PAID"),o(),s("ngIf",e.appointment.status==="CONFIRMED"&&e.appointment.paymentStatus==="PENDING"),o(),s("ngIf",e.appointment.paymentStatus!=="PAID"&&!(e.appointment.status==="CONFIRMED"&&e.appointment.paymentStatus==="PENDING"))}}function ot(n,t){if(n&1){let e=w();r(0,"div",53),_("click",function(){u(e);let a=c().$implicit,p=c(4);return x(p.openAppointmentDetails(a.appointment))}),m(1,Ze,5,2,"div",79)(2,it,4,3,"div",54),r(3,"div",80)(4,"div",56),d(5),l(),r(6,"div"),d(7),l(),r(8,"div",50),d(9),l()()()}if(n&2){let e=c().$implicit,i=c().ngIf,a=c(3);h("rounded-lg border-l-4 shadow-sm cursor-pointer hover:shadow hover:scale-[1.01] transition-all relative group/card flex items-center "+a.getAppointmentColorClass(e.appointment)),s("ngClass",i.length>=3?"w-8 h-8 p-0 justify-center":"flex-1 p-2 min-w-[140px]"),o(),s("ngIf",i.length<3),o(),s("ngIf",i.length>=3),o(3),f(e.appointment.patientName),o(2),f(a.getDoctorName(e.appointment.doctorId)),o(2),S("",a.getAppointmentStatusLabel(e.appointment)," ")}}function at(n,t){if(n&1&&(E(0),m(1,Xe,9,6,"button",69)(2,ot,10,8,"div",46),D()),n&2){let e=t.$implicit;o(),s("ngIf",e.type==="available"),o(),s("ngIf",e.type==="booked")}}function rt(n,t){if(n&1&&(E(0),m(1,qe,1,0,"div",67),r(2,"div",42),m(3,at,3,2,"ng-container",43),l(),D()),n&2){let e=t.ngIf;o(),s("ngIf",e.length===0),o(),s("ngClass",e.length>=3?"flex flex-wrap content-start gap-1 p-1":"flex gap-2"),o(),s("ngForOf",e)}}function lt(n,t){if(n&1&&(E(0),r(1,"div",66),m(2,rt,4,3,"ng-container",16),l(),D()),n&2){let e=c().$implicit,i=c();o(2),s("ngIf",i.getSlotStatus(i.currentDate().toISOString().split("T")[0],e,0))}}function st(n,t){if(n&1&&(r(0,"div",38)(1,"div",39),d(2),l(),m(3,Ye,2,1,"ng-container",16)(4,lt,3,1,"ng-container",16),l()),n&2){let e=t.$implicit,i=c();h((i.viewMode()==="week"?"grid-cols-8":"grid-cols-[auto_1fr]")+(i.isBreakTime(e)?" bg-gray-100":"")),o(2),S(" ",e," "),o(),s("ngIf",i.viewMode()==="week"),o(),s("ngIf",i.viewMode()==="day")}}function dt(n,t){if(n&1&&(r(0,"option",26),d(1),l()),n&2){let e=t.$implicit;s("value",e.specialtyId),o(),f(e.name)}}function ct(n,t){if(n&1&&(r(0,"option",26),d(1),l()),n&2){let e=t.$implicit;s("value",e.doctorId),o(),S("",e.fullName," ")}}function pt(n,t){if(n&1&&(r(0,"option",26),d(1),l()),n&2){let e=t.$implicit;s("value",e.patientId),o(),$("",e.fullName," (",e.dni,") ")}}function mt(n,t){if(n&1){let e=w();r(0,"button",20),_("click",function(){let a=u(e).$implicit,p=c(3);return x(p.modalTime.set(a))}),d(1),l()}if(n&2){let e=t.$implicit,i=c(3);h("py-3 px-2 text-sm font-bold rounded-xl border-2 transition-all duration-200 "+(i.modalTime()===e?"bg-blue-600 border-blue-600 text-white shadow-lg shadow-blue-200 scale-105":"bg-white border-gray-200 text-gray-700 hover:border-blue-400 hover:shadow-md hover:scale-102")),o(),S(" ",e," ")}}function _t(n,t){if(n&1&&(r(0,"div",121),m(1,mt,2,3,"button",122),l()),n&2){let e=c(2);o(),s("ngForOf",e.availableSlotsForModal())}}function gt(n,t){if(n&1&&(r(0,"div",123),g(1,"lucide-icon",124),r(2,"p",125),d(3,"Selecciona m\xE9dico y fecha para ver disponibilidad "),l()()),n&2){let e=c(2);o(),s("img",e.icons.Clock)}}function ut(n,t){n&1&&(r(0,"div",126),g(1,"div",127),r(2,"p",128),d(3,"Guardando cita..."),l()())}function xt(n,t){if(n&1){let e=w();r(0,"div",86)(1,"div",87)(2,"div",88)(3,"div",89)(4,"div")(5,"h2",90),d(6,"Agendar nueva cita"),l(),r(7,"p",91),d(8,"Selecciona los detalles de tu consulta"),l()(),r(9,"button",92),_("click",function(){u(e);let a=c();return x(a.closeModal())}),g(10,"lucide-icon",93),l()()(),r(11,"div",94)(12,"div",95)(13,"div",96)(14,"div")(15,"h3",97),d(16,"Detalles de la cita "),l(),r(17,"p",98),d(18,"Selecciona los detalles de tu consulta"),l()(),r(19,"div")(20,"label",99),d(21," Especialidad "),l(),r(22,"select",100),_("ngModelChange",function(a){u(e);let p=c();return p.modalSpecialtyId.set(a),x(p.modalDoctorId.set(""))}),r(23,"option",101),d(24,"Seleccionar especialidad"),l(),m(25,dt,2,2,"option",8),l()(),r(26,"div")(27,"label",99),d(28," M\xE9dico "),l(),r(29,"select",102),_("ngModelChange",function(a){u(e);let p=c();return x(p.modalDoctorId.set(a))}),r(30,"option",101),d(31,"Seleccionar m\xE9dico"),l(),m(32,ct,2,2,"option",8),l()(),r(33,"div")(34,"label",99),d(35," Fecha "),l(),r(36,"input",103),_("ngModelChange",function(a){u(e);let p=c();return x(p.modalDate.set(a))}),l()(),r(37,"div")(38,"label",99),d(39," Seleccionar paciente "),l(),r(40,"select",100),_("ngModelChange",function(a){u(e);let p=c();return x(p.modalPatientId.set(a))}),r(41,"option",101),d(42,"Seleccionar paciente"),l(),m(43,pt,2,3,"option",8),l()()(),r(44,"div",104)(45,"h3",105),d(46," Horarios disponibles "),l(),r(47,"p",106),d(48,"Elige una hora disponible"),l(),m(49,_t,2,1,"div",107)(50,gt,4,1,"div",108),l()(),r(51,"div",109)(52,"h3",110),d(53,"M\xE9todo de pago"),l(),r(54,"div",111)(55,"button",112),_("click",function(){u(e);let a=c();return x(a.modalPaymentMethod.set("CASH"))}),g(56,"lucide-icon",113),r(57,"span"),d(58," Efectivo "),l(),r(59,"span",114),d(60,"En cl\xEDnica"),l()(),r(61,"button",112),_("click",function(){u(e);let a=c();return x(a.modalPaymentMethod.set("YAPE"))}),g(62,"lucide-icon",113),r(63,"span"),d(64," Yape "),l()(),r(65,"button",112),_("click",function(){u(e);let a=c();return x(a.modalPaymentMethod.set("PLIN"))}),g(66,"lucide-icon",113),r(67,"span"),d(68," Plin "),l()(),r(69,"button",112),_("click",function(){u(e);let a=c();return x(a.modalPaymentMethod.set("CARD"))}),g(70,"lucide-icon",113),r(71,"span"),d(72," Tarjeta "),l()()(),r(73,"div")(74,"label",99),d(75," Notas adicionales "),l(),r(76,"textarea",115),_("ngModelChange",function(a){u(e);let p=c();return x(p.modalNotes.set(a))}),l()()()(),r(77,"div",116)(78,"button",117),_("click",function(){u(e);let a=c();return x(a.closeModal())}),g(79,"lucide-icon",118),d(80," Cancelar "),l(),r(81,"button",119),_("click",function(){u(e);let a=c();return x(a.saveAppointment())}),g(82,"lucide-icon",12),d(83," Confirmar cita "),l()(),m(84,ut,4,0,"div",120),l()()}if(n&2){let e=c();o(10),s("img",e.icons.AlertCircle),o(12),s("ngModel",e.modalSpecialtyId()),o(3),s("ngForOf",e.specialties()),o(4),s("ngModel",e.modalDoctorId())("disabled",!e.modalSpecialtyId()),o(3),s("ngForOf",e.filteredDoctorsForModal()),o(4),s("ngModel",e.modalDate()),o(4),s("ngModel",e.modalPatientId()),o(3),s("ngForOf",e.patients()),o(6),s("ngIf",e.availableSlotsForModal().length>0),o(),s("ngIf",e.availableSlotsForModal().length===0),o(5),h("relative flex flex-col items-center justify-center p-4 rounded-xl border-2 transition-all "+(e.modalPaymentMethod()==="CASH"?"border-blue-600 bg-blue-50 shadow-md":"border-gray-200 bg-white hover:border-blue-300")),o(),h(e.modalPaymentMethod()==="CASH"?"text-blue-600":"text-gray-400"),s("img",e.icons.User),o(),h("text-xs font-bold "+(e.modalPaymentMethod()==="CASH"?"text-blue-600":"text-gray-600")),o(4),h("relative flex flex-col items-center justify-center p-4 rounded-xl border-2 transition-all "+(e.modalPaymentMethod()==="YAPE"?"border-blue-600 bg-blue-50 shadow-md":"border-gray-200 bg-white hover:border-blue-300")),o(),h(e.modalPaymentMethod()==="YAPE"?"text-blue-600":"text-gray-400"),s("img",e.icons.User),o(),h("text-xs font-bold "+(e.modalPaymentMethod()==="YAPE"?"text-blue-600":"text-gray-600")),o(2),h("relative flex flex-col items-center justify-center p-4 rounded-xl border-2 transition-all "+(e.modalPaymentMethod()==="PLIN"?"border-blue-600 bg-blue-50 shadow-md":"border-gray-200 bg-white hover:border-blue-300")),o(),h(e.modalPaymentMethod()==="PLIN"?"text-blue-600":"text-gray-400"),s("img",e.icons.User),o(),h("text-xs font-bold "+(e.modalPaymentMethod()==="PLIN"?"text-blue-600":"text-gray-600")),o(2),h("relative flex flex-col items-center justify-center p-4 rounded-xl border-2 transition-all "+(e.modalPaymentMethod()==="CARD"?"border-blue-600 bg-blue-50 shadow-md":"border-gray-200 bg-white hover:border-blue-300")),o(),h(e.modalPaymentMethod()==="CARD"?"text-blue-600":"text-gray-400"),s("img",e.icons.User),o(),h("text-xs font-bold "+(e.modalPaymentMethod()==="CARD"?"text-blue-600":"text-gray-600")),o(5),s("ngModel",e.modalNotes()),o(2),s("disabled",e.saving()),o(),s("img",e.icons.AlertCircle),o(2),s("disabled",e.saving()||!e.modalPatientId()||!e.modalTime()||!e.modalDoctorId()),o(),s("img",e.icons.CheckCircle),o(2),s("ngIf",e.saving())}}function ft(n,t){if(n&1&&(r(0,"div",143)(1,"label",140),d(2,"Notas"),l(),r(3,"p",144),d(4),l()()),n&2){let e=c(3);o(4),f(e.selectedAppointment.notes)}}function bt(n,t){if(n&1&&(r(0,"div",94)(1,"div",135)(2,"div",136),g(3,"lucide-icon",137),r(4,"div")(5,"h3",34),d(6),l(),r(7,"p",138),d(8,"Paciente"),l()()()(),r(9,"div",139)(10,"div")(11,"label",140),d(12,"M\xE9dico"),l(),r(13,"p",141),d(14),l()(),r(15,"div")(16,"label",140),d(17,"Especialidad"),l(),r(18,"p",141),d(19),l()(),r(20,"div")(21,"label",140),d(22,"Fecha"),l(),r(23,"p",141),d(24),l()(),r(25,"div")(26,"label",140),d(27,"Horario"),l(),r(28,"p",141),d(29),l()(),r(30,"div")(31,"label",140),d(32,"Estado"),l(),r(33,"span"),d(34),l()(),r(35,"div")(36,"label",140),d(37,"M\xE9todo de pago"),l(),r(38,"p",141),d(39),l()()(),m(40,ft,5,1,"div",142),l()),n&2){let e=c(2);o(3),s("img",e.icons.User),o(3),f(e.selectedAppointment.patientName),o(8),f(e.getDoctorName(e.selectedAppointment.doctorId)),o(5),S("",e.getSpecialtyName(e.selectedAppointment.specialtyId)," "),o(5),f(e.selectedAppointment.appointmentDate),o(5),$("",e.selectedAppointment.startTime," - ",e.selectedAppointment.endTime),o(4),h("inline-block px-3 py-1 rounded-full text-xs font-bold "+(e.selectedAppointment.status==="CONFIRMED"?"bg-green-100 text-green-700":e.selectedAppointment.status==="COMPLETED"?"bg-blue-100 text-blue-700":e.selectedAppointment.status==="CANCELLED"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700")),o(),S(" ",e.selectedAppointment.status," "),o(5),f(e.selectedAppointment.paymentMethod||"N/A"),o(),s("ngIf",e.selectedAppointment.notes)}}function vt(n,t){if(n&1&&(r(0,"option",26),d(1),l()),n&2){let e=t.$implicit;s("value",e.id),o(),S(" ",e.fullName," ")}}function ht(n,t){if(n&1){let e=w();r(0,"button",20),_("click",function(){let a=u(e).$implicit,p=c(3);return x(p.modalTime.set(a))}),d(1),l()}if(n&2){let e=t.$implicit,i=c(3);h("py-2 px-2 text-sm font-bold rounded-lg border-2 transition-all "+(i.modalTime()===e?"bg-blue-600 border-blue-600 text-white":"bg-white border-gray-200 text-gray-700 hover:border-blue-400")),o(),S(" ",e," ")}}function yt(n,t){if(n&1){let e=w();r(0,"div",94)(1,"div",96)(2,"div",145)(3,"p",146),d(4," Solo puedes cambiar el m\xE9dico y el horario para esta especialidad. "),l()(),r(5,"div",147)(6,"div")(7,"label",99),d(8,"Especialidad"),l(),r(9,"div",148),d(10),l()(),r(11,"div")(12,"label",99),d(13,"M\xE9dico"),l(),r(14,"select",149),_("ngModelChange",function(a){u(e);let p=c(2);return x(p.modalDoctorId.set(a))}),m(15,vt,2,2,"option",8),l()()(),r(16,"div")(17,"label",99),d(18,"Nueva fecha"),l(),r(19,"input",103),_("ngModelChange",function(a){u(e);let p=c(2);return x(p.modalDate.set(a))}),l()(),r(20,"div")(21,"label",99),d(22,"Nuevo horario"),l(),r(23,"div",150),m(24,ht,2,3,"button",122),l()()()()}if(n&2){let e=c(2);o(10),S(" ",e.getSpecialtyName(e.modalSpecialtyId())," "),o(4),s("ngModel",e.modalDoctorId()),o(),s("ngForOf",e.doctorsInCurrentSpecialty()),o(4),s("ngModel",e.modalDate()),o(5),s("ngForOf",e.availableSlotsForModal())}}function Ct(n,t){if(n&1){let e=w();r(0,"div",151)(1,"div",152),g(2,"lucide-icon",153),l(),r(3,"h3",154),d(4,"\xBFConfirmar cancelaci\xF3n?"),l(),r(5,"p",155),d(6),l(),r(7,"div",156)(8,"button",157),_("click",function(){u(e);let a=c(2);return x(a.cancelCancelConfirmation())}),d(9," No, mantener cita "),l(),r(10,"button",158),_("click",function(){u(e);let a=c(2);return x(a.confirmCancel())}),d(11," S\xED, cancelar cita "),l()()()}if(n&2){let e=c(2);o(2),s("img",e.icons.AlertCircle),o(4),S(" \xBFEst\xE1s seguro de que deseas cancelar la cita de **",e.selectedAppointment==null?null:e.selectedAppointment.patientName,"**? Esta acci\xF3n no se puede deshacer. ")}}function St(n,t){if(n&1){let e=w();r(0,"button",164),_("click",function(){u(e);let a=c(3);return x(a.showCancelConfirmation())}),g(1,"lucide-icon",12),d(2," Cancelar cita "),l()}if(n&2){let e=c(3);o(),s("img",e.icons.AlertCircle)}}function wt(n,t){if(n&1){let e=w();r(0,"button",165),_("click",function(){u(e);let a=c(3);return x(a.startRescheduling())}),g(1,"lucide-icon",12),d(2," Reprogramar "),l()}if(n&2){let e=c(3);o(),s("img",e.icons.Calendar)}}function It(n,t){if(n&1){let e=w();r(0,"button",166),_("click",function(){u(e);let a=c(3);return x(a.saveRescheduledAppointment())}),g(1,"lucide-icon",12),d(2," Guardar cambios "),l()}if(n&2){let e=c(3);s("disabled",!e.modalTime()||!e.modalDate()||!e.modalDoctorId()),o(),s("img",e.icons.CheckCircle)}}function At(n,t){if(n&1){let e=w();r(0,"div",116)(1,"button",159),_("click",function(){u(e);let a=c(2);return x(a.closeDetailsModal())}),d(2," Cerrar "),l(),r(3,"div",160),m(4,St,3,1,"button",161)(5,wt,3,1,"button",162)(6,It,3,2,"button",163),l()()}if(n&2){let e=c(2);o(4),s("ngIf",!e.isRescheduling&&(e.selectedAppointment==null?null:e.selectedAppointment.status)!=="CANCELLED"),o(),s("ngIf",!e.isRescheduling&&(e.selectedAppointment==null?null:e.selectedAppointment.status)!=="CANCELLED"),o(),s("ngIf",e.isRescheduling)}}function Et(n,t){if(n&1){let e=w();r(0,"div",86)(1,"div",129)(2,"div",130)(3,"div",89)(4,"div")(5,"h2",90),d(6,"Detalles de la cita"),l(),r(7,"p",131),d(8,"Informaci\xF3n completa de la consulta"),l()(),r(9,"button",92),_("click",function(){u(e);let a=c();return x(a.closeDetailsModal())}),g(10,"lucide-icon",93),l()()(),m(11,bt,41,12,"div",132)(12,yt,25,5,"div",132)(13,Ct,12,2,"div",133)(14,At,7,3,"div",134),l()()}if(n&2){let e=c();o(10),s("img",e.icons.AlertCircle),o(),s("ngIf",e.selectedAppointment&&!e.isRescheduling&&!e.isConfirmingCancel),o(),s("ngIf",e.isRescheduling),o(),s("ngIf",e.isConfirmingCancel),o(),s("ngIf",!e.isConfirmingCancel)}}var Ae=class n{appointmentsService=k(L);doctorService=k(ye);specialtyService=k(he);scheduleService=k(Se);patientsService=k(Ie);doctorSpecialtyService=k(Ce);configService=k(we);icons={ChevronLeft:te,ChevronRight:ne,Calendar:ee,User:de,Clock:re,Plus:le,Search:se,AlertCircle:ie,CheckCircle:oe,HelpCircle:ae};config=this.configService.settings;isWorkingDay(t){let e=(t+1)%7;return this.config().workingDays.includes(e)}isBreakTime(t){let e=this.config().breakStartTime,i=this.config().breakEndTime;return!e||!i?!1:t>=e&&t<i}viewMode=C("week");doctors=this.doctorService.doctors;specialties=this.specialtyService.specialties;patients=this.patientsService.patients;appointments=this.appointmentsService.appointments;selectedDoctorId=C("");selectedSpecialtyId=C("");constructor(){this.scheduleService.refreshSchedules(),W(()=>{let t=this.currentDate(),e=this.viewMode(),i,a;if(e==="week"){let p=this.getStartOfWeek(t),y=new Date(p);y.setDate(p.getDate()+6),i=p.toISOString().split("T")[0],a=y.toISOString().split("T")[0]}else i=a=t.toISOString().split("T")[0];this.appointmentsService.refreshAppointmentsByRange(i,a)})}currentDate=C(new Date);currentDateStr=N(()=>this.currentDate().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}));isModalOpen=!1;saving=C(!1);selectedSlot=null;modalPatientId=C("");modalSpecialtyId=C("");modalDoctorId=C("");modalDate=C(new Date().toISOString().split("T")[0]);modalTime=C("");modalNotes=C("");modalPaymentMethod=C("CASH");modalTransactionId=C("");isDetailsModalOpen=!1;selectedAppointment=null;isRescheduling=!1;isConfirmingCancel=!1;doctorsInCurrentSpecialty=N(()=>{let t=this.isRescheduling?this.modalSpecialtyId():this.selectedSpecialtyId();if(!t)return this.doctors();let i=this.doctorSpecialtyService.associations().filter(a=>a.specialtyId===t).map(a=>a.doctorId);return this.doctors().filter(a=>a.doctorId!=null&&i.includes(a.doctorId))});globalAppointments=N(()=>{let t=this.currentDate().toISOString().split("T")[0];return this.appointments().filter(e=>e.appointmentDate===t&&e.status!=="CANCELLED")});filteredDoctorsForModal=N(()=>{let t=this.modalSpecialtyId();if(!t)return[];let i=this.doctorSpecialtyService.associations().filter(a=>a.specialtyId===t).map(a=>a.doctorId);return this.doctors().filter(a=>a.doctorId!=null&&i.includes(a.doctorId))});availableSlotsForModal=N(()=>{let t=this.modalDoctorId(),e=this.modalSpecialtyId(),i=this.modalDate();if(!t||!e||!i)return[];let a=this.getDuration(t,e),p=v=>v.length>5?v.substring(0,5):v,y=this.scheduleService.getSchedulesForDoctor(t,e).filter(v=>v.date===i);if(y.length===0)return[];let b=[];for(let v of y){let I=this.getMinutes(p(v.startTime)),M=this.getMinutes(p(v.endTime)),T=I;for(;T+a<=M;)b.push(this.formatMinutes(T)),T+=a}return b.filter(v=>!this.appointments().some(M=>M.doctorId===t&&M.appointmentDate===i&&M.startTime===v&&M.status!=="CANCELLED"))});weekDays=N(()=>{let t=this.getStartOfWeek(this.currentDate()),e=[];for(let i=0;i<7;i++){let a=new Date(t);a.setDate(t.getDate()+i);let p=[a.getFullYear(),(a.getMonth()+1).toString().padStart(2,"0"),a.getDate().toString().padStart(2,"0")].join("-");e.push({date:a,iso:p,dayName:a.toLocaleDateString("es-ES",{weekday:"short"}).replace(".",""),dayNum:a.getDate(),monthName:a.toLocaleDateString("es-ES",{month:"short"}).replace(".","")})}return e});getMinutes(t){let[e,i]=t.split(":").map(Number);return e*60+i}formatMinutes(t){let e=Math.floor(t/60),i=t%60;return`${e.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}timeSlots=N(()=>{let t=30,e=this.selectedDoctorId(),i=this.selectedSpecialtyId();if(e&&i){let v=this.doctorSpecialtyService.associations().find(I=>I.doctorId===e&&I.specialtyId===i);v&&v.durationMinutes>0&&(t=v.durationMinutes)}let a=480,p=1200;if(e){let v=this.scheduleService.schedules().filter(I=>I.doctorId===e);if(i&&(v=v.filter(I=>I.specialtyId===i)),v.length>0){let I=v.map(A=>this.getMinutes(A.startTime)),M=v.map(A=>this.getMinutes(A.endTime)),T=Math.min(...I),P=Math.max(...M);a=T,p=P}}let y=[],b=a;for(;b+t<=p;)y.push(this.formatMinutes(b)),b+=t;return y});getStartOfWeek(t){let e=new Date(t),i=e.getDay(),a=e.getDate()-i+(i===0?-6:1);return new Date(e.setDate(a))}changeWeek(t){let e=new Date(this.currentDate());this.viewMode()==="week"?e.setDate(e.getDate()+t*7):e.setDate(e.getDate()+t),this.currentDate.set(e)}toggleView(t){this.viewMode.set(t)}isPastDate(t){let e=new Date;return e.setHours(0,0,0,0),new Date(t+"T00:00:00")<e}isPastTime(t,e){if(this.isPastDate(t))return!0;let i=new Date().toISOString().split("T")[0];if(t===i){let a=new Date,[p,y]=e.split(":").map(Number),b=new Date;return b.setHours(p,y,0,0),b<a}return!1}getSlotStatus(t,e,i){let a=[],p=this.isPastTime(t,e),y=this.selectedDoctorId()?[this.selectedDoctorId()]:this.doctorsInCurrentSpecialty().map(b=>b.doctorId||b.id);for(let b of y){let v=this.getDoctorName(b),I=this.appointments().find(A=>A.doctorId===b&&A.appointmentDate===t&&A.startTime===e&&A.status!=="CANCELLED");if(I){a.push({type:"booked",appointment:I});continue}let M=!1,T="",P=A=>A.length>5?A.substring(0,5):A;if(this.selectedSpecialtyId())M=this.scheduleService.getSchedulesForDoctor(b,this.selectedSpecialtyId()).some(V=>V.date===t&&e>=P(V.startTime)&&e<P(V.endTime)),T=this.selectedSpecialtyId();else{let V=this.scheduleService.schedules().filter(F=>F.doctorId===b).find(F=>F.date===t&&e>=P(F.startTime)&&e<P(F.endTime));V&&(M=!0,T=V.specialtyId)}M&&a.push({type:"available",doctorId:b,doctorName:v,date:t,time:e,specialtyId:T,isPast:p})}return a}getAppointmentsForSlot(t,e){return this.getSlotStatus(t,e,0).filter(a=>a.type==="booked").map(a=>a.appointment)}openBookingModal(t,e,i,a){this.selectedSlot={date:t,time:e},this.modalPatientId.set(""),this.modalSpecialtyId.set(a||this.selectedSpecialtyId()||""),this.modalDoctorId.set(i||this.selectedDoctorId()||""),this.modalDate.set(t),this.modalTime.set(e),this.modalNotes.set(""),this.modalPaymentMethod.set("CASH"),this.modalTransactionId.set(""),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}getDuration(t,e){let i=this.doctorSpecialtyService.associations().find(a=>a.doctorId===t&&a.specialtyId===e);return i&&i.durationMinutes>0?i.durationMinutes:30}saveAppointment(){let t=this.modalDoctorId(),e=this.modalSpecialtyId(),i=this.modalDate(),a=this.modalTime(),p=this.modalPatientId();if(t&&e&&i&&a&&p){let y=this.patients().find(v=>v.patientId===p),b=this.getDuration(t,e);this.saving.set(!0),this.appointmentsService.addAppointment({doctorId:t,specialtyId:e,patientId:p,patientName:y?.fullName||"Desconocido",appointmentDate:i,startTime:a,endTime:this.addMinutes(a,b),notes:this.modalNotes(),paymentMethod:this.modalPaymentMethod(),paymentStatus:this.modalPaymentMethod()==="CASH"?"PENDING":"PAID",transactionId:this.modalTransactionId()}).subscribe({next:()=>{this.saving.set(!1),this.closeModal()},error:()=>this.saving.set(!1)})}}addMinutes(t,e){let[i,a]=t.split(":").map(Number),p=new Date;return p.setHours(i,a+e),`${p.getHours().toString().padStart(2,"0")}:${p.getMinutes().toString().padStart(2,"0")}`}getDoctorName(t){return this.doctors().find(e=>e.id===t||e.doctorId===t)?.fullName||"Desconocido"}getSpecialtyName(t){return this.specialties().find(e=>e.specialtyId===t)?.name||"Desconocido"}getAppointmentColorClass(t){return t.paymentStatus==="PAID"?"bg-green-100 border-green-600 text-green-800":"bg-yellow-100 border-yellow-500 text-yellow-800"}openGenericBooking(){let t=new Date().toISOString().split("T")[0],e=this.timeSlots(),i=e.find(a=>this.getSlotStatus(t,a,0).some(p=>p.type==="available"));i?this.openBookingModal(t,i):this.openBookingModal(t,e[0]||"09:00")}openAppointmentDetails(t){this.selectedAppointment=t,this.isDetailsModalOpen=!0,this.isRescheduling=!1}closeDetailsModal(){this.isDetailsModalOpen=!1,this.selectedAppointment=null,this.isRescheduling=!1,this.isConfirmingCancel=!1}startRescheduling(){this.selectedAppointment&&(this.isRescheduling=!0,this.isConfirmingCancel=!1,this.modalSpecialtyId.set(this.selectedAppointment.specialtyId),this.modalDoctorId.set(this.selectedAppointment.doctorId),this.modalDate.set(this.selectedAppointment.appointmentDate),this.modalTime.set(this.selectedAppointment.startTime),this.modalPatientId.set(this.selectedAppointment.patientId),this.modalNotes.set(this.selectedAppointment.notes||""),this.modalPaymentMethod.set(this.selectedAppointment.paymentMethod||"CASH"),this.modalTransactionId.set(this.selectedAppointment.transactionId||""))}showCancelConfirmation(){this.isConfirmingCancel=!0,this.isRescheduling=!1}cancelCancelConfirmation(){this.isConfirmingCancel=!1}confirmCancel(){this.selectedAppointment&&(this.appointmentsService.updatestatus(this.selectedAppointment.appointmentId,"CANCELLED"),this.closeDetailsModal(),this.isConfirmingCancel=!1)}saveRescheduledAppointment(){if(this.selectedAppointment&&this.modalTime()&&this.modalDate()){let t=this.modalDoctorId()||this.selectedAppointment.doctorId,e=this.modalSpecialtyId()||this.selectedAppointment.specialtyId,i=this.getDuration(t,e),a=j(O({},this.selectedAppointment),{doctorId:t,specialtyId:e,appointmentDate:this.modalDate(),startTime:this.modalTime(),endTime:this.addMinutes(this.modalTime(),i),notes:this.modalNotes(),paymentMethod:this.modalPaymentMethod(),transactionId:this.modalTransactionId()}),p=this.appointments(),y=p.findIndex(b=>b.appointmentId===this.selectedAppointment.appointmentId);y!==-1&&(p[y]=a,this.appointmentsService.appointments.set([...p])),this.closeDetailsModal()}}cancelAppointment(){this.selectedAppointment&&(this.appointmentsService.updatestatus(this.selectedAppointment.appointmentId,"CANCELLED"),this.closeDetailsModal())}getAppointmentStatusLabel(t){return t.paymentStatus==="PAID"?"Pagada":(t.status==="CONFIRMED"&&t.paymentStatus==="PENDING","Reservada")}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=H({type:n,selectors:[["app-appointments-calendar"]],decls:43,vars:19,consts:[[1,"h-full","flex","flex-col"],[1,"bg-white","border-b","border-gray-200","px-6","py-4","flex","flex-col","md:flex-row","md:items-center","justify-between","gap-4"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"flex","items-center","gap-4"],[1,"relative"],[1,"appearance-none","bg-white","border","border-gray-300","text-gray-700","text-sm","rounded-xl","focus:ring-blue-500","focus:border-blue-500","block","w-full","pl-3","pr-8","py-2.5","shadow-sm","hover:border-gray-400","transition-colors","cursor-pointer","font-medium",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"pointer-events-none","absolute","inset-y-0","right-0","flex","items-center","px-2","text-gray-500"],[1,"w-4","h-4","rotate-90",3,"img"],[1,"flex","items-center","gap-2","bg-blue-600","hover:bg-blue-700","text-white","px-6","py-2.5","rounded-xl","text-sm","font-bold","shadow-lg","shadow-blue-200","transition-all","active:scale-95","whitespace-nowrap",3,"click"],[1,"w-5","h-5",3,"img"],[1,"flex","items-center","bg-gray-100","rounded-xl","p-1","shadow-inner"],[1,"p-2","hover:bg-white","hover:shadow-sm","rounded-lg","transition-all","text-gray-600",3,"click"],[1,"px-4","text-center","min-w-[180px]"],[4,"ngIf"],[1,"flex-1","overflow-auto","bg-gray-50","p-2","sm:p-6"],[1,"flex","items-center","justify-end","mb-4","px-1"],[1,"bg-gray-200","p-1","rounded-lg","inline-flex"],[3,"click"],[1,"bg-white","rounded-xl","shadow","border","border-gray-200","overflow-hidden","min-w-[800px]"],[1,"grid","border-b","border-gray-200","bg-gray-50","sticky","top-0","z-10"],[1,"p-4","text-xs","font-semibold","text-gray-400","uppercase","tracking-wider","text-center","border-r","border-gray-200","w-20","flex","items-center","justify-center"],["class","grid border-b border-gray-100 last:border-b-0 min-h-[3.5rem]",3,"class",4,"ngFor","ngForOf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",4,"ngIf"],[3,"value"],[1,"block","text-sm","font-bold","text-gray-900","leading-none","mb-1"],[1,"block","text-[10px]","font-bold","text-gray-500","uppercase","tracking-wider"],[1,"block","text-sm","font-bold","text-gray-900","capitalize","leading-none"],["class","p-4 text-center border-r border-gray-200 last:border-r-0",4,"ngFor","ngForOf"],[1,"p-4","text-center","border-r","border-gray-200","last:border-r-0"],[1,"text-xs","font-semibold","text-gray-500","uppercase","mb-1"],[1,"flex","flex-col","items-center","leading-none"],[1,"text-lg","font-bold","text-gray-900"],[1,"text-[10px]","font-bold","text-gray-400","uppercase","mt-0.5"],[1,"p-4","text-center"],[1,"text-xs","font-semibold","text-gray-500","uppercase"],[1,"grid","border-b","border-gray-100","last:border-b-0","min-h-[3.5rem]"],[1,"w-20","p-2","text-xs","font-medium","text-gray-500","text-center","border-r","border-gray-100","flex","items-center","justify-center","bg-gray-50/50"],[3,"class",4,"ngFor","ngForOf"],["class","absolute inset-0 bg-gray-50/50 -z-10",4,"ngIf"],[1,"w-full","h-full","relative","z-10",3,"ngClass"],[4,"ngFor","ngForOf"],[1,"absolute","inset-0","bg-gray-50/50","-z-10"],["class","rounded border transition-all group flex flex-col justify-center items-center gap-0.5 relative",3,"disabled","ngClass","click",4,"ngIf"],[3,"ngClass","class","click",4,"ngIf"],[1,"rounded","border","transition-all","group","flex","flex-col","justify-center","items-center","gap-0.5","relative",3,"click","disabled","ngClass"],["class","w-4 h-4 text-blue-500",3,"img",4,"ngIf"],[1,"absolute","bottom-full","left-1/2","-translate-x-1/2","mb-2","w-max","max-w-[150px]","bg-gray-900","text-white","text-[10px]","rounded","px-2","py-1","opacity-0","group-hover:opacity-100","transition-opacity","pointer-events-none","z-50","shadow-lg","text-center"],[1,"opacity-75"],[1,"text-[9px]","text-blue-500","opacity-80","truncate","w-full","text-center","pb-0.5"],[1,"w-4","h-4","text-blue-500",3,"img"],[3,"click","ngClass"],["class","w-full h-full flex items-center justify-center",4,"ngIf"],[1,"absolute","bottom-full","left-1/2","-translate-x-1/2","mb-2","w-max","max-w-[150px]","bg-gray-900","text-white","text-[10px]","rounded","px-2","py-1","opacity-0","group-hover:opacity-100","transition-opacity","pointer-events-none","z-50","shadow-lg","text-left"],[1,"font-bold"],[1,"font-bold","text-[10px]","truncate","w-full"],[1,"truncate","text-[9px]","opacity-80","w-full"],[1,"w-full","h-full","flex","items-center","justify-center"],["class","w-4 h-4 text-green-600",3,"img",4,"ngIf"],["class","w-4 h-4 text-yellow-600",3,"img",4,"ngIf"],["class","text-[9px] font-bold",4,"ngIf"],[1,"w-4","h-4","text-green-600",3,"img"],[1,"w-4","h-4","text-yellow-600",3,"img"],[1,"text-[9px]","font-bold"],[1,"relative","p-2","bg-white"],["class","absolute inset-0 bg-gray-50/40 pattern-diagonal-lines",4,"ngIf"],[1,"absolute","inset-0","bg-gray-50/40","pattern-diagonal-lines"],["class","rounded-lg bg-blue-50 border border-blue-200 border-dashed hover:bg-blue-100 hover:border-solid hover:shadow-md transition-all flex items-center gap-2 group/card cursor-pointer relative",3,"ngClass","click",4,"ngIf"],[1,"rounded-lg","bg-blue-50","border","border-blue-200","border-dashed","hover:bg-blue-100","hover:border-solid","hover:shadow-md","transition-all","flex","items-center","gap-2","group/card","cursor-pointer","relative",3,"click","ngClass"],["class","text-left overflow-hidden",4,"ngIf"],["class","w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0 group-hover/card:bg-blue-200 transition-colors",4,"ngIf"],[1,"absolute","bottom-full","left-1/2","-translate-x-1/2","mb-2","w-max","max-w-[200px]","bg-gray-900","text-white","text-xs","rounded","px-2","py-1","opacity-0","group-hover/card:opacity-100","transition-opacity","pointer-events-none","z-50","shadow-lg"],[1,"text-left","overflow-hidden"],[1,"text-xs","font-bold","text-blue-600","truncate","group-hover/card:text-blue-700"],[1,"text-[10px]","text-blue-500","font-medium","truncate"],[1,"w-6","h-6","rounded-full","bg-blue-100","flex","items-center","justify-center","flex-shrink-0","group-hover/card:bg-blue-200","transition-colors"],[1,"w-3","h-3","text-blue-600",3,"img"],["class","overflow-hidden w-full",4,"ngIf"],[1,"absolute","bottom-full","left-1/2","-translate-x-1/2","mb-2","w-max","max-w-[200px]","bg-gray-900","text-white","text-xs","rounded","px-2","py-1","opacity-0","group-hover/card:opacity-100","transition-opacity","pointer-events-none","z-50","shadow-lg","text-left"],[1,"overflow-hidden","w-full"],[1,"font-bold","text-xs","truncate"],[1,"text-[10px]","opacity-90","truncate"],["class","text-[10px] font-bold text-center",4,"ngIf"],[1,"text-[10px]","font-bold","text-center"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","rounded-2xl","shadow-2xl","w-full","max-w-3xl","max-h-[90vh]","overflow-y-auto","relative"],[1,"bg-gradient-to-r","from-blue-600","to-blue-700","px-8","py-6","rounded-t-2xl"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-white"],[1,"text-blue-100","text-sm","mt-1"],[1,"text-white","hover:bg-white","hover:bg-opacity-20","rounded-lg","p-2","transition-all",3,"click"],[1,"w-6","h-6","rotate-45",3,"img"],[1,"p-8"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"space-y-5"],[1,"text-sm","font-bold","text-gray-700","uppercase","tracking-wide","mb-4"],[1,"text-xs","text-gray-500","mb-4"],[1,"block","text-xs","font-bold","text-gray-600","uppercase","tracking-wide","mb-2"],[1,"w-full","rounded-xl","border-2","border-gray-200","py-3","px-4","text-sm","font-medium","focus:border-blue-500","focus:ring-2","focus:ring-blue-200","transition-all","outline-none",3,"ngModelChange","ngModel"],["value","","disabled",""],[1,"w-full","rounded-xl","border-2","border-gray-200","py-3","px-4","text-sm","font-medium","focus:border-blue-500","focus:ring-2","focus:ring-blue-200","transition-all","outline-none","disabled:bg-gray-50","disabled:text-gray-400",3,"ngModelChange","ngModel","disabled"],["type","date",1,"w-full","rounded-xl","border-2","border-gray-200","py-3","px-4","text-sm","font-medium","focus:border-blue-500","focus:ring-2","focus:ring-blue-200","transition-all","outline-none",3,"ngModelChange","ngModel"],[1,"bg-gradient-to-br","from-gray-50","to-blue-50","rounded-2xl","p-6","border-2","border-gray-100"],[1,"text-sm","font-bold","text-gray-700","uppercase","tracking-wide","mb-2","text-center"],[1,"text-xs","text-gray-500","mb-4","text-center"],["class","grid grid-cols-3 gap-3 max-h-[320px] overflow-y-auto pr-2 custom-scrollbar",4,"ngIf"],["class","h-[320px] flex flex-col items-center justify-center text-center text-gray-400",4,"ngIf"],[1,"mt-8","pt-8","border-t-2","border-gray-100"],[1,"text-sm","font-bold","text-gray-700","uppercase","tracking-wide","mb-5"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-3","mb-6"],["type","button",3,"click"],[1,"w-6","h-6","mb-2",3,"img"],[1,"text-xs","text-gray-500","mt-1"],["placeholder","Escribe cualquier nota relevante para el m\xE9dico...","rows","3",1,"w-full","rounded-xl","border-2","border-gray-200","py-3","px-4","text-sm","focus:border-blue-500","focus:ring-2","focus:ring-blue-200","transition-all","outline-none","resize-none",3,"ngModelChange","ngModel"],[1,"bg-gray-50","px-8","py-5","flex","flex-col-reverse","sm:flex-row","gap-3","border-t-2","border-gray-100","rounded-b-2xl"],["type","button",1,"flex-1","sm:flex-none","inline-flex","items-center","justify-center","gap-2","rounded-xl","bg-white","border-2","border-gray-300","px-6","py-3","text-sm","font-bold","text-gray-700","hover:bg-gray-50","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"w-5","h-5","rotate-45",3,"img"],["type","button",1,"flex-1","inline-flex","items-center","justify-center","gap-2","rounded-xl","bg-blue-600","px-8","py-3","text-sm","font-bold","text-white","shadow-lg","shadow-blue-200","hover:bg-blue-700","transition-all","disabled:opacity-50","disabled:cursor-not-allowed","disabled:shadow-none",3,"click","disabled"],["class","absolute inset-0 bg-white bg-opacity-80 rounded-2xl flex flex-col items-center justify-center z-50",4,"ngIf"],[1,"grid","grid-cols-3","gap-3","max-h-[320px]","overflow-y-auto","pr-2","custom-scrollbar"],[3,"class","click",4,"ngFor","ngForOf"],[1,"h-[320px]","flex","flex-col","items-center","justify-center","text-center","text-gray-400"],[1,"w-16","h-16","mb-4","opacity-20",3,"img"],[1,"text-sm","font-medium","px-6"],[1,"absolute","inset-0","bg-white","bg-opacity-80","rounded-2xl","flex","flex-col","items-center","justify-center","z-50"],[1,"w-10","h-10","border-4","border-blue-200","border-t-blue-600","rounded-full","animate-spin","mb-4"],[1,"text-sm","font-bold","text-gray-700"],[1,"bg-white","rounded-2xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","overflow-y-auto"],[1,"bg-gradient-to-r","from-indigo-600","to-purple-700","px-8","py-6","rounded-t-2xl"],[1,"text-indigo-100","text-sm","mt-1"],["class","p-8",4,"ngIf"],["class","p-12 text-center",4,"ngIf"],["class","bg-gray-50 px-8 py-5 flex flex-col-reverse sm:flex-row gap-3 border-t-2 border-gray-100 rounded-b-2xl",4,"ngIf"],[1,"bg-gradient-to-br","from-blue-50","to-indigo-50","rounded-xl","p-6","mb-6","border-2","border-blue-100"],[1,"flex","items-center","gap-3"],[1,"w-8","h-8","text-blue-600",3,"img"],[1,"text-sm","text-gray-600"],[1,"grid","grid-cols-2","gap-6","mb-6"],[1,"block","text-xs","font-bold","text-gray-500","uppercase","mb-2"],[1,"text-sm","font-medium","text-gray-900"],["class","bg-gray-50 rounded-xl p-4",4,"ngIf"],[1,"bg-gray-50","rounded-xl","p-4"],[1,"text-sm","text-gray-700"],[1,"bg-yellow-50","border-l-4","border-yellow-400","p-4","mb-4"],[1,"text-sm","text-yellow-700","italic"],[1,"grid","grid-cols-2","gap-4"],[1,"w-full","rounded-xl","border-2","border-gray-100","bg-gray-50","py-3","px-4","text-sm","font-bold","text-gray-500","italic"],[1,"w-full","rounded-xl","border-2","border-gray-200","py-3","px-4","text-sm","font-medium","focus:border-blue-500","outline-none","transition-all",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-4","gap-2","max-h-48","overflow-y-auto","pr-2","custom-scrollbar"],[1,"p-12","text-center"],[1,"w-20","h-20","bg-red-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-6"],[1,"w-10","h-10","text-red-600",3,"img"],[1,"text-2xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600","mb-8","max-w-md","mx-auto"],[1,"flex","gap-4"],[1,"flex-1","py-4","bg-gray-100","text-gray-700","font-bold","rounded-xl","hover:bg-gray-200","transition-all",3,"click"],[1,"flex-1","py-4","bg-red-600","text-white","font-bold","rounded-xl","hover:bg-red-700","transition-all","shadow-lg","shadow-red-200",3,"click"],["type","button",1,"flex-1","sm:flex-none","inline-flex","items-center","justify-center","gap-2","rounded-xl","bg-white","border-2","border-gray-300","px-6","py-3","text-sm","font-bold","text-gray-700","hover:bg-gray-50","transition-all",3,"click"],[1,"flex-1","flex","gap-3"],["type","button","class","flex-1 inline-flex items-center justify-center gap-2 rounded-xl bg-red-600 px-6 py-3 text-sm font-bold text-white hover:bg-red-700 transition-all",3,"click",4,"ngIf"],["type","button","class","flex-1 inline-flex items-center justify-center gap-2 rounded-xl bg-indigo-600 px-6 py-3 text-sm font-bold text-white shadow-lg shadow-indigo-200 hover:bg-indigo-700 transition-all",3,"click",4,"ngIf"],["type","button","class","flex-1 inline-flex items-center justify-center gap-2 rounded-xl bg-blue-600 px-8 py-3 text-sm font-bold text-white shadow-lg shadow-blue-200 hover:bg-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",3,"disabled","click",4,"ngIf"],["type","button",1,"flex-1","inline-flex","items-center","justify-center","gap-2","rounded-xl","bg-red-600","px-6","py-3","text-sm","font-bold","text-white","hover:bg-red-700","transition-all",3,"click"],["type","button",1,"flex-1","inline-flex","items-center","justify-center","gap-2","rounded-xl","bg-indigo-600","px-6","py-3","text-sm","font-bold","text-white","shadow-lg","shadow-indigo-200","hover:bg-indigo-700","transition-all",3,"click"],["type","button",1,"flex-1","inline-flex","items-center","justify-center","gap-2","rounded-xl","bg-blue-600","px-8","py-3","text-sm","font-bold","text-white","shadow-lg","shadow-blue-200","hover:bg-blue-700","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),d(4,"Agenda de citas"),l(),r(5,"p",3),d(6,"Gestiona los turnos y citas m\xE9dicas globales."),l()(),r(7,"div",4)(8,"div",5)(9,"select",6),_("ngModelChange",function(p){return i.selectedSpecialtyId.set(p)}),r(10,"option",7),d(11,"Todas las especialidades"),l(),m(12,De,2,2,"option",8),l(),r(13,"div",9),g(14,"lucide-icon",10),l()(),r(15,"button",11),_("click",function(){return i.openGenericBooking()}),g(16,"lucide-icon",12),d(17," Nueva cita "),l(),r(18,"div",13)(19,"button",14),_("click",function(){return i.changeWeek(-1)}),g(20,"lucide-icon",12),l(),r(21,"div",15),m(22,Me,5,5,"ng-container",16)(23,ke,4,3,"ng-container",16),l(),r(24,"button",14),_("click",function(){return i.changeWeek(1)}),g(25,"lucide-icon",12),l()()()(),r(26,"div",17)(27,"div",18)(28,"div",19)(29,"button",20),_("click",function(){return i.toggleView("day")}),d(30," D\xEDa "),l(),r(31,"button",20),_("click",function(){return i.toggleView("week")}),d(32," Semana "),l()()(),r(33,"div",21)(34,"div",22)(35,"div",23),d(36," Hora "),l(),m(37,Ne,2,1,"ng-container",16)(38,Pe,4,1,"ng-container",16),l(),r(39,"div",5),m(40,st,5,5,"div",24),l()()()(),m(41,xt,85,45,"div",25)(42,Et,15,5,"div",25)),e&2&&(o(9),s("ngModel",i.selectedSpecialtyId()),o(3),s("ngForOf",i.specialties()),o(2),s("img",i.icons.ChevronRight),o(2),s("img",i.icons.Plus),o(4),s("img",i.icons.ChevronLeft),o(2),s("ngIf",i.viewMode()==="week"),o(),s("ngIf",i.viewMode()==="day"),o(2),s("img",i.icons.ChevronRight),o(4),h("px-4 py-1.5 text-sm font-bold rounded-md transition-all "+(i.viewMode()==="day"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800")),o(2),h("px-4 py-1.5 text-sm font-bold rounded-md transition-all "+(i.viewMode()==="week"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800")),o(3),h(i.viewMode()==="week"?"grid-cols-8":"grid-cols-[auto_1fr]"),o(3),s("ngIf",i.viewMode()==="week"),o(),s("ngIf",i.viewMode()==="day"),o(2),s("ngForOf",i.timeSlots()),o(),s("ngIf",i.isModalOpen),o(),s("ngIf",i.isDetailsModalOpen))},dependencies:[Q,Y,q,J,ve,fe,be,_e,xe,ge,ue,pe,ce,K],styles:[".custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:10px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:10px}.custom-scrollbar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.scale-102[_ngcontent-%COMP%]{transform:scale(1.02)}"]})};export{Ae as AppointmentsCalendarComponent};
