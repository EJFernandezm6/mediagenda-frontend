import{a as L}from"./chunk-FTFAWZSP.js";import{b as z,d as E,g as V,u as F}from"./chunk-OABQPEKD.js";import{a as A}from"./chunk-KR7YXPEX.js";import{$ as g,Ba as l,Bb as C,Dd as O,Ra as x,Sd as T,Td as k,Va as p,Vb as _,W as f,Yb as w,a as y,aa as h,b as D,cb as c,db as s,eb as a,fb as S,ia as d,mb as v,mc as I,nb as m,nc as N,ob as u,vc as M,zb as b}from"./chunk-2BMW4ZRB.js";function P(n,e){if(n&1){let t=v();s(0,"div",8),m("click",function(){g(t);let o=u();return h(o.isOpen.set(!1))}),a()}}function j(n,e){if(n&1){let t=v();s(0,"li",11),m("click",function(){let o=g(t).$implicit,r=u(2);return h(r.selectDoctor(o))}),s(1,"span",12),b(2),a()()}if(n&2){let t=e.$implicit;l(2),C(" ",t.displayName," ")}}function q(n,e){if(n&1&&(s(0,"ul",9),p(1,j,3,1,"li",10),a()),n&2){let t=u();l(),c("ngForOf",t.filteredOptions())}}function B(n,e){n&1&&(s(0,"ul",13)(1,"li",14),b(2," No se encontraron resultados "),a()())}var $=class n{doctorService=f(A);doctorSpecialtyService=f(L);selectedDoctorId=d("");disabled=d(!1);selectionChanged=w();set setDisabled(e){this.disabled.set(e)}isOpen=d(!1);searchText=d("");doctors=this.doctorService.selectableDoctors;icons={Search:O};formattedDoctors=_(()=>{let e=this.doctorSpecialtyService.associations(),t=new Set(e.map(o=>o.doctorId)),i=new Map;return this.doctors().filter(o=>{let r=o.doctorId||o.id;return t.has(r)}).forEach(o=>{let r=o.doctorId||o.id;i.has(r)||i.set(r,D(y({},o),{valueId:r,displayName:o.dni?`${o.dni} - ${o.fullName}`:o.fullName}))}),Array.from(i.values())});filteredOptions=_(()=>{let e=this.searchText().toLowerCase();return this.formattedDoctors().filter(t=>t.displayName.toLowerCase().includes(e))});onSearchChange(e){this.searchText.set(e),this.isOpen.set(!0)}selectDoctor(e){if(!e.valueId){console.warn("Selected doctor has no doctorId/valueId",e);return}this.selectedDoctorId.set(e.valueId),this.searchText.set(e.displayName),this.isOpen.set(!1),this.selectionChanged.emit(e.valueId)}clear(){this.selectedDoctorId.set(""),this.searchText.set(""),this.selectionChanged.emit("")}setValue(e){let t=this.formattedDoctors().find(i=>i.valueId===e);t?(this.selectedDoctorId.set(e),this.searchText.set(t.displayName)):(this.selectedDoctorId.set(""),this.searchText.set(""))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=x({type:n,selectors:[["app-doctor-selector"]],inputs:{setDisabled:[0,"disabled","setDisabled"]},outputs:{selectionChanged:"selectionChanged"},decls:8,vars:5,consts:[[1,"relative","w-full"],["class","fixed inset-0 z-30 cursor-default bg-transparent",3,"click",4,"ngIf"],[1,"relative","z-40"],["type","text","placeholder","Buscar por DNI o Nombre...",1,"block","w-full","rounded-md","border-gray-300","py-2","pl-3","pr-10","text-base","focus:border-primary","focus:outline-none","focus:ring-primary","sm:text-sm","border","disabled:bg-gray-100","disabled:text-gray-500",3,"ngModelChange","focus","ngModel"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-2","pointer-events-none"],[1,"h-4","w-4","text-gray-400",3,"img"],["class","absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",4,"ngIf"],["class","absolute z-50 mt-1 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",4,"ngIf"],[1,"fixed","inset-0","z-30","cursor-default","bg-transparent",3,"click"],[1,"absolute","z-50","mt-1","max-h-60","w-full","overflow-auto","rounded-md","bg-white","py-1","text-base","shadow-lg","ring-1","ring-black","ring-opacity-5","focus:outline-none","sm:text-sm"],["class","relative cursor-pointer select-none py-2 pl-3 pr-9 text-gray-900 hover:bg-primary",3,"click",4,"ngFor","ngForOf"],[1,"relative","cursor-pointer","select-none","py-2","pl-3","pr-9","text-gray-900","hover:bg-primary",3,"click"],[1,"block","truncate","font-normal"],[1,"absolute","z-50","mt-1","w-full","overflow-auto","rounded-md","bg-white","py-1","text-base","shadow-lg","ring-1","ring-black","ring-opacity-5","focus:outline-none","sm:text-sm"],[1,"relative","cursor-default","select-none","py-2","pl-3","pr-9","text-gray-500"]],template:function(t,i){t&1&&(s(0,"div",0),p(1,P,1,0,"div",1),s(2,"div",2)(3,"input",3),m("ngModelChange",function(r){return i.onSearchChange(r)})("focus",function(){return i.isOpen.set(!0)}),a(),s(4,"div",4),S(5,"lucide-icon",5),a(),p(6,q,2,1,"ul",6)(7,B,3,0,"ul",7),a()()),t&2&&(l(),c("ngIf",i.isOpen()),l(2),c("ngModel",i.searchText()),l(2),c("img",i.icons.Search),l(),c("ngIf",i.isOpen()&&i.filteredOptions().length>0),l(),c("ngIf",i.isOpen()&&i.filteredOptions().length===0))},dependencies:[M,I,N,F,z,E,V,k,T],styles:[".dropdown-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:30;background:transparent}"]})};export{$ as a};
