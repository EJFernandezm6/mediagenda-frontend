import{a as K}from"./chunk-LJ3HISHF.js";import{a as J}from"./chunk-U7G55PT5.js";import{a as V}from"./chunk-XTHUABNB.js";import{a as B,b as q,d as G,g as H,u as Z}from"./chunk-OABQPEKD.js";import"./chunk-MZ3EZVY4.js";import{$ as p,Ab as S,Ad as D,Ba as a,Bb as L,Bd as W,Dd as F,Eb as x,Fb as h,Gb as _,Jc as A,Kd as z,Ra as k,Sd as O,Td as j,Va as v,W as y,a as C,aa as u,ba as E,ca as M,cb as l,db as i,eb as n,fb as f,mb as b,mc as I,nb as g,nc as T,ob as m,vc as P,yb as w,yd as N,zb as c}from"./chunk-2BMW4ZRB.js";function R(d,o){d&1&&(i(0,"span",32),f(1,"div",33),c(2,"Activo "),n())}function U(d,o){d&1&&(i(0,"span",32),f(1,"div",34),c(2,"Inactivo "),n())}function X(d,o){if(d&1){let e=b();i(0,"div",18)(1,"div",19)(2,"button",20),g("click",function(){let r=p(e).$implicit,s=m();return u(s.toggleActive(r))}),f(3,"lucide-icon",7),n(),i(4,"button",21),g("click",function(){let r=p(e).$implicit,s=m();return u(s.openModal(r))}),f(5,"lucide-icon",7),n(),i(6,"button",22),g("click",function(){let r=p(e).$implicit,s=m();return u(s.delete(r.specialtyId))}),f(7,"lucide-icon",7),n()(),i(8,"div",23)(9,"div",24)(10,"div",25),f(11,"lucide-icon",26),n(),i(12,"div",27)(13,"h3",28),c(14),n(),i(15,"div",29),v(16,R,3,0,"span",30)(17,U,3,0,"span",30),n(),i(18,"p",31),c(19),n()()()()()}if(d&2){let e=o.$implicit,t=m();a(2),w(e.active?"text-emerald-600 bg-emerald-50 hover:bg-emerald-100":"text-red-600 bg-red-50 hover:bg-red-100"),l("title",e.active?"Desactivar":"Activar"),a(),l("img",t.icons.Power),a(2),l("img",t.icons.Pencil),a(2),l("img",t.icons.Trash2),a(3),w(e.active?"bg-primary/10 text-primary":"bg-gray-100 text-gray-400"),a(),l("img",t.icons.Activity),a(3),S(e.name),a(2),l("ngIf",e.active),a(),l("ngIf",!e.active),a(),l("title",e.description),a(),S(e.description||"Sin descripci\xF3n")}}function Y(d,o){if(d&1){let e=b();i(0,"div",35)(1,"div",36)(2,"div",37),g("click",function(){p(e);let r=m();return u(r.closeModal())}),n(),i(3,"div",38)(4,"div",39)(5,"button",40),g("click",function(){p(e);let r=m();return u(r.closeModal())}),i(6,"span",41),c(7,"Cerrar"),n(),E(),i(8,"svg",42),f(9,"path",43),n()()(),M(),i(10,"div",44)(11,"h3",45),c(12),n(),i(13,"div",46)(14,"div",13)(15,"label",47),c(16,"Nombre"),n(),i(17,"div")(18,"input",48),_("ngModelChange",function(r){p(e);let s=m();return h(s.form.name,r)||(s.form.name=r),u(r)}),n()()(),i(19,"div",13)(20,"label",47),c(21,"Descripci\xF3n"),n(),i(22,"div")(23,"input",48),_("ngModelChange",function(r){p(e);let s=m();return h(s.form.description,r)||(s.form.description=r),u(r)}),n()()(),i(24,"div",49)(25,"input",50),_("ngModelChange",function(r){p(e);let s=m();return h(s.form.active,r)||(s.form.active=r),u(r)}),n(),i(26,"label",51),c(27,"Activo"),n()()()(),i(28,"div",52)(29,"button",53),g("click",function(){p(e);let r=m();return u(r.save())}),c(30,"Guardar"),n(),i(31,"button",54),g("click",function(){p(e);let r=m();return u(r.closeModal())}),c(32,"Cancelar"),n()()()()()}if(d&2){let e=m();a(12),L(" ",e.editingId?"Editar Especialidad":"Nueva Especialidad"," "),a(6),x("ngModel",e.form.name),a(5),x("ngModel",e.form.description),a(2),x("ngModel",e.form.active)}}var Q=class d{service=y(J);confirmService=y(V);icons={Plus:D,Pencil:N,Trash2:z,Search:F,Power:W,Activity:A};specialties=this.service.specialties;searchTerm="";currentPage=1;itemsPerPage=6;isModalOpen=!1;editingId=null;form={name:"",description:"",active:!0};get specialtiesList(){return this.specialties()}get totalItems(){return this.service.totalElements()}onPageChange(o){this.currentPage=o,this.loadSpecialties()}onSearchChange(){this.currentPage=1,this.loadSpecialties()}onSearchInput(o){let e=o.target,t=e.value.replace(/[^a-zA-Z áéíóúÁÉÍÓÚñÑ]/g,"");e.value!==t&&(e.value=t),this.searchTerm=t,this.onSearchChange()}loadSpecialties(){this.service.refreshSpecialties(this.currentPage-1,this.itemsPerPage,this.searchTerm)}openModal(o){o?(this.editingId=o.specialtyId,this.form=C({},o)):(this.editingId=null,this.form={name:"",description:"",active:!0}),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}save(){if(this.specialtiesList.some(e=>e.name.toLowerCase().trim()===this.form.name.toLowerCase().trim()&&e.specialtyId!==this.editingId)){alert(`La especialidad "${this.form.name}" ya existe.`);return}this.editingId?this.service.updateSpecialty(this.editingId,this.form).subscribe({next:()=>this.closeModal(),error:e=>alert("Error al actualizar especialidad: "+(e.error?.message||e.message))}):this.service.addSpecialty(this.form).subscribe({next:()=>this.closeModal(),error:e=>alert("Error al crear especialidad: "+(e.error?.message||e.message))})}toggleActive(o){this.service.updateStatus(o.specialtyId,!o.active).subscribe()}async delete(o){await this.confirmService.confirm({title:"Eliminar Especialidad",message:"\xBFEst\xE1s seguro de que deseas eliminar esta especialidad?",confirmText:"Eliminar",cancelText:"Cancelar"})&&this.service.deleteSpecialty(o).subscribe({error:()=>alert("No se pudo eliminar la especialidad. Es posible que est\xE9 asignada a uno o m\xE1s m\xE9dicos en este momento.")})}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=k({type:d,selectors:[["app-specialties-list"]],decls:21,vars:8,consts:[[1,"px-4","sm:px-6","lg:px-8"],[1,"sm:flex","sm:items-center"],[1,"sm:flex-auto"],[1,"text-xl","font-semibold","text-gray-900"],[1,"mt-2","text-sm","text-gray-700"],[1,"mt-4","sm:ml-16","sm:mt-0","sm:flex-none"],[1,"block","rounded-md","bg-primary","px-3","py-2","text-center","text-sm","font-semibold","text-white","shadow-sm","hover:bg-primary","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-primary","flex","items-center","gap-2",3,"click"],[1,"w-4","h-4",3,"img"],[1,"mt-8","flow-root"],[1,"mb-4","relative","max-w-xs"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],[1,"h-5","w-5","text-gray-400",3,"img"],["type","text","placeholder","Buscar...",1,"block","w-full","pl-10","pr-3","py-2","border","border-gray-300","rounded-md","leading-5","bg-white","placeholder-gray-500","focus:outline-none","focus:placeholder-gray-400","focus:border-primary","focus:shadow-outline-blue","sm:text-sm","transition","duration-150","ease-in-out",3,"input","ngModel"],[1,"mb-4"],[3,"pageChange","currentPage","totalItems","pageSize"],[1,"grid","grid-cols-1","gap-6","sm:grid-cols-2","lg:grid-cols-3"],["class","col-span-1 divide-y divide-gray-200 rounded-xl bg-white shadow-float border border-gray-100 transition-all hover:shadow-lg relative pt-4",4,"ngFor","ngForOf"],["class","fixed inset-0 z-10 w-screen overflow-y-auto",4,"ngIf"],[1,"col-span-1","divide-y","divide-gray-200","rounded-xl","bg-white","shadow-float","border","border-gray-100","transition-all","hover:shadow-lg","relative","pt-4"],[1,"absolute","top-3","right-3","flex","items-center","gap-1","z-10"],[1,"p-1.5","rounded-md","transition-colors","focus:outline-none","focus:ring-2","focus:ring-offset-1","focus:ring-primary",3,"click","title"],["title","Editar",1,"p-1.5","text-primary","hover:text-blue-900","bg-primary","hover:bg-primary","rounded-md","transition-colors",3,"click"],["title","Eliminar",1,"p-1.5","text-red-600","hover:text-red-900","bg-red-50","hover:bg-red-100","rounded-md","transition-colors",3,"click"],[1,"p-6","relative"],[1,"flex","items-start","mt-2"],[1,"p-3","rounded-lg","mr-4","flex-shrink-0"],[1,"w-6","h-6",3,"img"],[1,"flex-1","pr-24"],[1,"text-lg","font-bold","text-gray-900","leading-tight","block","truncate","mb-1"],[1,"mb-3"],["class","inline-flex items-center gap-1.5 px-2 py-0.5 text-xs font-medium text-main whitespace-nowrap",4,"ngIf"],[1,"text-sm","text-gray-500","line-clamp-3",3,"title"],[1,"inline-flex","items-center","gap-1.5","px-2","py-0.5","text-xs","font-medium","text-main","whitespace-nowrap"],[1,"w-1.5","h-1.5","rounded-full","bg-success"],[1,"w-1.5","h-1.5","rounded-full","bg-red-500"],[1,"fixed","inset-0","z-10","w-screen","overflow-y-auto"],[1,"flex","min-h-full","items-end","justify-center","p-4","text-center","sm:items-center","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],[1,"relative","transform","overflow-hidden","rounded-lg","bg-white","px-4","pb-4","pt-5","text-left","shadow-xl","transition-all","sm:my-8","sm:w-full","sm:max-w-lg","sm:p-6"],[1,"absolute","right-0","top-0","hidden","pr-4","pt-4","sm:block"],["type","button",1,"rounded-md","bg-white","text-gray-400","hover:text-gray-500",3,"click"],[1,"sr-only"],["fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"mt-3","text-center","sm:ml-4","sm:mt-0","sm:text-left","w-full"],[1,"text-base","font-semibold","leading-6","text-gray-900"],[1,"mt-4","space-y-4"],[1,"block","text-sm","font-medium","leading-6","text-gray-900","mb-2"],["type","text",1,"block","w-full","rounded-md","border-0","py-1.5","px-4","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","placeholder:text-gray-400","focus:ring-2","focus:ring-inset","focus:ring-primary","sm:text-sm","sm:leading-6",3,"ngModelChange","ngModel"],[1,"flex","items-center"],["type","checkbox",1,"h-4","w-4","rounded","border-gray-300","text-primary","focus:ring-primary",3,"ngModelChange","ngModel"],[1,"ml-2","block","text-sm","text-gray-900"],[1,"mt-5","sm:mt-4","sm:flex","sm:flex-row-reverse"],["type","button",1,"inline-flex","w-full","justify-center","rounded-md","bg-primary","px-3","py-2","text-sm","font-semibold","text-white","shadow-sm","hover:bg-primary","sm:ml-3","sm:w-auto",3,"click"],["type","button",1,"mt-3","inline-flex","w-full","justify-center","rounded-md","bg-white","px-3","py-2","text-sm","font-semibold","text-gray-900","shadow-sm","ring-1","ring-inset","ring-gray-300","hover:bg-gray-50","sm:mt-0","sm:w-auto",3,"click"]],template:function(e,t){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),c(4,"Especialidades"),n(),i(5,"p",4),c(6,"Lista de especialidades m\xE9dicas disponibles en la cl\xEDnica."),n()(),i(7,"div",5)(8,"button",6),g("click",function(){return t.openModal()}),f(9,"lucide-icon",7),c(10," Nueva Especialidad "),n()()(),i(11,"div",8)(12,"div",9)(13,"div",10),f(14,"lucide-icon",11),n(),i(15,"input",12),g("input",function(s){return t.onSearchInput(s)}),n()(),i(16,"div",13)(17,"app-pagination",14),g("pageChange",function(s){return t.onPageChange(s)}),n()(),i(18,"div",15),v(19,X,20,14,"div",16),n()()(),v(20,Y,33,4,"div",17)),e&2&&(a(9),l("img",t.icons.Plus),a(5),l("img",t.icons.Search),a(),l("ngModel",t.searchTerm),a(2),l("currentPage",t.currentPage)("totalItems",t.totalItems)("pageSize",t.itemsPerPage),a(2),l("ngForOf",t.specialtiesList),a(),l("ngIf",t.isModalOpen))},dependencies:[P,I,T,j,O,Z,q,B,G,H,K],encapsulation:2})};export{Q as SpecialtiesListComponent};
