<div class="relative w-full">
    <!-- Overlay to close dropdown when clicking outside -->
    <div *ngIf="isOpen()" (click)="isOpen.set(false)" class="fixed inset-0 z-30 cursor-default bg-transparent"></div>

    <div class="relative z-40">
        <input type="text" [ngModel]="searchText()" (ngModelChange)="onSearchChange($event)" (focus)="isOpen.set(true)"
            [placeholder]="placeholder" [disabled]="disabledState()"
            class="block w-full rounded-md border-gray-300 py-2.5 pl-3 pr-10 text-base focus:border-primary focus:outline-none focus:ring-primary sm:text-sm border disabled:bg-gray-100 disabled:text-gray-500 bg-white shadow-sm disabled:shadow-none"
            [ngClass]="{'py-2': displayMode === 'compact', 'py-2.5': displayMode === 'default'}">

        <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
            <lucide-icon [img]="icons.Search" class="h-4 w-4 text-gray-400"></lucide-icon>
        </div>

        <!-- Dropdown List -->
        <ul *ngIf="isOpen() && filteredOptions().length > 0"
            class="absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm">
            <li *ngFor="let option of filteredOptions()" (click)="selectOption(option)"
                class="relative cursor-pointer select-none py-2 pl-3 pr-9 text-gray-900 hover:bg-primary flex flex-col">
                <span class="block truncate font-normal">
                    {{ option.label }}
                </span>
                <span *ngIf="option.description" class="block truncate text-xs text-gray-500 mt-0.5">
                    {{ option.description }}
                </span>
            </li>
        </ul>

        <ul *ngIf="isOpen() && filteredOptions().length === 0"
            class="absolute z-50 mt-1 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm">
            <li class="relative cursor-default select-none py-2 pl-3 pr-9 text-gray-500">
                No se encontraron resultados
            </li>
        </ul>
    </div>
</div>