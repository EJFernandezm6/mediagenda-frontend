import{e as c}from"./chunk-AHP2GZON.js";import{a as u}from"./chunk-MZ3EZVY4.js";import{N as s,R as n,W as i,ia as a,tc as l}from"./chunk-XATCTO35.js";var m=class e{http=i(l);router=i(c);apiUrl=`${u.apiUrl}/iam/auth`;currentUser=a(null);constructor(){this.restoreSession()}login(r){return this.http.post(`${this.apiUrl}/login`,r).pipe(s(t=>{let o={id:t.userId,fullName:t.fullName||"",email:t.email,roles:[],photoUrl:`https://ui-avatars.com/api/?name=${t.email}&background=0D8ABC&color=fff`,subscriptionStatus:"ACTIVE",clinicId:t.clinicId};this.currentUser.set(o),localStorage.setItem("token",t.accessToken),localStorage.setItem("user",JSON.stringify(o)),this.router.navigate(["/app/dashboard"])}))}logout(){this.currentUser.set(null),localStorage.removeItem("user"),localStorage.removeItem("token"),this.router.navigate(["/auth/login"])}restoreSession(){let r=localStorage.getItem("user"),t=localStorage.getItem("token");r&&t&&this.currentUser.set(JSON.parse(r))}static \u0275fac=function(t){return new(t||e)};static \u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})};export{m as a};
