import{d as c}from"./chunk-G2AI53GJ.js";import{a as u}from"./chunk-KX3FC5ET.js";import{J as s,N as a,S as o,ac as l,ea as n}from"./chunk-SWYYGHOG.js";var m=class e{http=o(l);router=o(c);apiUrl=`${u.apiUrl}/iam/auth`;currentUser=n(null);constructor(){this.restoreSession()}login(r){return this.http.post(`${this.apiUrl}/login`,r).pipe(s(t=>{let i={id:t.userId,fullName:t.fullName||"",email:t.email,roles:[],photoUrl:`https://ui-avatars.com/api/?name=${t.email}&background=0D8ABC&color=fff`,subscriptionStatus:"ACTIVE"};this.currentUser.set(i),localStorage.setItem("token",t.accessToken),localStorage.setItem("user",JSON.stringify(i)),this.router.navigate(["/app/dashboard"])}))}logout(){this.currentUser.set(null),localStorage.removeItem("user"),localStorage.removeItem("token"),this.router.navigate(["/auth/login"])}restoreSession(){let r=localStorage.getItem("user"),t=localStorage.getItem("token");r&&t&&this.currentUser.set(JSON.parse(r))}static \u0275fac=function(t){return new(t||e)};static \u0275prov=a({token:e,factory:e.\u0275fac,providedIn:"root"})};export{m as a};
